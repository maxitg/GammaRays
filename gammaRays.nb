(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    117553,       2569]
NotebookOptionsPosition[    114581,       2470]
NotebookOutlinePosition[    114956,       2487]
CellTagsIndexPosition[    114913,       2484]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Spectral Lags in Very High Energy Emission of GRBs", "Title",
 CellChangeTimes->{{3.589934697031559*^9, 3.5899347180121403`*^9}, {
  3.592131457104278*^9, 3.592131457862741*^9}}],

Cell[CellGroupData[{

Cell["Model", "Section",
 CellChangeTimes->{{3.5899347262060547`*^9, 3.589934726570508*^9}}],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.592131230779949*^9, 3.592131235512723*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"universe", "=", 
   RowBox[{"{", 
    RowBox[{"Hobs_", ",", "\[CapitalOmega]m_"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59218334620009*^9, 3.592183353694758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"population", "=", 
   RowBox[{"{", 
    RowBox[{"density0_", ",", "index_", ",", "zc_"}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.59219620251681*^9, 3.592196268277416*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"burst", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Gamma]_", ",", "\[Eta]0_", ",", "r0_", ",", "n_", ",", "\[Omega]0_", 
     ",", "\[Theta]0_", ",", "k_", ",", "\[Alpha]_"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.592183357425045*^9, 3.592183376861951*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"observer", "=", 
   RowBox[{"{", 
    RowBox[{"detectorArea_", ",", "z_", ",", "\[Chi]_"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.592183378338565*^9, 3.592183385685248*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relativity", "Subsection",
 CellChangeTimes->{{3.589934837712495*^9, 3.589934839766659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", "\[Gamma]_", "]"}], ":=", 
   SqrtBox[
    RowBox[{"1", "-", 
     FractionBox["1", 
      SuperscriptBox["\[Gamma]", "2"]]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.589934850463387*^9, 3.589934856887154*^9}, {
  3.589935711872209*^9, 3.589935711942636*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cosmology", "Subsection",
 CellChangeTimes->{{3.5899347427477713`*^9, 3.5899347438265457`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]\[CapitalLambda]", "[", "\[CapitalOmega]m_", "]"}],
    ":=", 
   RowBox[{"1", "-", "\[CapitalOmega]m"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5899349782326403`*^9, 3.589935000464473*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"distance", "[", 
    RowBox[{"universe", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "Hobs"], 
    SqrtBox[
     FractionBox["1", 
      RowBox[{
      "\[CapitalOmega]\[CapitalLambda]", "[", "\[CapitalOmega]m", "]"}]]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}], 
       RowBox[{"Hypergeometric2F1", "[", 
        RowBox[{
         FractionBox["1", "3"], ",", 
         FractionBox["1", "2"], ",", 
         FractionBox["4", "3"], ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["\[CapitalOmega]m", 
            RowBox[{
            "\[CapitalOmega]\[CapitalLambda]", "[", "\[CapitalOmega]m", 
             "]"}]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}], "3"]}]}], "]"}]}], "-", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        FractionBox["1", "3"], ",", 
        FractionBox["1", "2"], ",", 
        FractionBox["4", "3"], ",", 
        RowBox[{"-", 
         FractionBox["\[CapitalOmega]m", 
          RowBox[{
          "\[CapitalOmega]\[CapitalLambda]", "[", "\[CapitalOmega]m", 
           "]"}]]}]}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.589934874380446*^9, 3.589934886285137*^9}, {
   3.5899349693113194`*^9, 3.589934972465304*^9}, {3.589935054177115*^9, 
   3.589935073915997*^9}, 3.589935110006753*^9, {3.589935151236059*^9, 
   3.5899351579007053`*^9}, {3.5921315009060917`*^9, 
   3.5921315207960997`*^9}, {3.592131935717617*^9, 3.592131979444818*^9}, {
   3.592132180555418*^9, 3.5921322199675827`*^9}, {3.5921322609963913`*^9, 
   3.592132261150456*^9}, {3.59218328690254*^9, 3.592183308931731*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"photonSphereArea", "[", 
    RowBox[{"universe_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"4", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"distance", "[", 
      RowBox[{"universe", ",", "z"}], "]"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.589935078530493*^9, 3.589935107355896*^9}, {
   3.589935149961955*^9, 3.589935159393393*^9}, {3.5901499169203653`*^9, 
   3.590149919694723*^9}, {3.592132276651806*^9, 3.59213231399308*^9}, 
   3.5921324338850183`*^9, {3.592132479674905*^9, 3.592132528442235*^9}, {
   3.59213259355765*^9, 3.592132602476036*^9}, 3.592132636578137*^9, {
   3.592132678985426*^9, 3.592132700320488*^9}, {3.5921328703605547`*^9, 
   3.592132878583001*^9}, {3.592134577303495*^9, 3.592134611119673*^9}, {
   3.59213464199679*^9, 3.5921346874769783`*^9}, {3.592134784446424*^9, 
   3.59213481159022*^9}, {3.592135038603594*^9, 3.592135057500444*^9}, {
   3.5921350909931173`*^9, 3.592135194454236*^9}, {3.59218331212173*^9, 
   3.592183333104171*^9}, {3.5921856212934513`*^9, 3.592185621370853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"burstsSphereArea", "[", 
    RowBox[{"universe_", ",", "z_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"4", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"distance", "[", 
       RowBox[{"universe", ",", "z"}], "]"}], "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "z"}], ")"}], "2"]]}], ";"}]], "Input",
 CellChangeTimes->{{3.589935120126265*^9, 3.58993516044965*^9}, {
  3.5901499204550657`*^9, 3.590149922334618*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"shellVolumePerRedshift", "[", 
    RowBox[{"universe", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"4", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"distance", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Hobs", ",", "\[CapitalOmega]m"}], "}"}], ",", "z"}], "]"}],
        "2"]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z"}], ")"}], "3"]], 
    FractionBox["1", 
     RowBox[{"Hobs", 
      SqrtBox[
       RowBox[{
        RowBox[{"\[CapitalOmega]m", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}], "3"]}], "+", 
        RowBox[{
        "\[CapitalOmega]\[CapitalLambda]", "[", "\[CapitalOmega]m", 
         "]"}]}]]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.589935175967778*^9, 3.589935290257773*^9}, {
  3.5918412554035797`*^9, 3.591841257099522*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Light curve", "Subsection",
 CellChangeTimes->{{3.589935318987741*^9, 3.5899353237047043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"i", "[", 
    RowBox[{
    "burst", ",", "z_", ",", "\[Chi]_", ",", "\[Omega]_", ",", "\[Theta]_", 
     ",", "\[Phi]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"\[Omega]", "\[Equal]", "\[Infinity]"}], ",", 
     "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", "k"}]], "\[Omega]", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Omega]", "\[Omega]0"], ")"}], "\[Alpha]"], 
      RowBox[{"ExpIntegralE", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[Alpha]", "+", "1"}], 
          RowBox[{"2", "k"}]], "+", "1"}], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["\[Theta]", "\[Theta]0"], ")"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["\[Omega]", "\[Omega]0"], ")"}], 
          RowBox[{
           RowBox[{"-", "2"}], "k"}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v", "[", "\[Gamma]", "]"}], "\[Gamma]", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"v", "[", "\[Gamma]", "]"}]], "-", "1", "+", 
              FractionBox[
               SuperscriptBox["\[Theta]", "2"], "2"], "+", 
              FractionBox[
               SuperscriptBox["\[Chi]", "2"], "2"], "-", 
              RowBox[{"\[Theta]", " ", "\[Chi]", " ", 
               RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}]}], ")"}], 
          RowBox[{
           RowBox[{"-", "2"}], "k"}]]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.589935483422423*^9, 3.5899356080330048`*^9}, {
  3.5899356967025957`*^9, 3.589935781512787*^9}, {3.589935933237218*^9, 
  3.589935964665523*^9}, {3.5899360834375477`*^9, 3.58993610489809*^9}, {
  3.5922732610821*^9, 3.592273261937419*^9}, {3.5922737181109123`*^9, 
  3.59227371911088*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"j", "[", 
    RowBox[{
    "burst", ",", "z_", ",", "\[Chi]_", ",", "\[Tau]_", ",", "\[Theta]_", ",",
      "\[Phi]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"\[Tau]", "\[Equal]", "\[Infinity]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r0", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"v", "[", "\[Gamma]", "]"}]], "-", "1", "+", 
           FractionBox[
            SuperscriptBox["\[Theta]", "2"], "2"], "+", 
           FractionBox[
            SuperscriptBox["\[Chi]", "2"], "2"], "-", 
           RowBox[{"\[Theta]", " ", "\[Chi]", " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}]}], ")"}], "3"], 
      FractionBox["\[Pi]", 
       RowBox[{"n", " ", 
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"3", "\[Pi]"}], "n"], "]"}]}]]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[Tau]", "3"], "3"], 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{"1", ",", 
        FractionBox["3", "n"], ",", 
        FractionBox[
         RowBox[{"n", "+", "3"}], "n"], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["\[Tau]", 
            RowBox[{"r0", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"v", "[", "\[Gamma]", "]"}]], "-", "1", "+", 
               FractionBox[
                SuperscriptBox["\[Theta]", "2"], "2"], "+", 
               FractionBox[
                SuperscriptBox["\[Chi]", "2"], "2"], "-", 
               RowBox[{"\[Theta]", " ", "\[Chi]", " ", 
                RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}]}]], ")"}], "n"]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5899357885882673`*^9, 3.5899358888161497`*^9}, {
  3.589935971703033*^9, 3.589936024047285*^9}, {3.589936089476865*^9, 
  3.589936099247167*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"universe_", ",", "burst", ",", "observer", ",", 
     RowBox[{"{", 
      RowBox[{"\[Tau]1_", ",", "\[Tau]2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1_", ",", "\[Omega]2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "burstValues", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"burstValues", "=", 
       RowBox[{"{", 
        RowBox[{
        "\[Gamma]", ",", "\[Eta]0", ",", "r0", ",", "n", ",", "\[Omega]0", 
         ",", "\[Theta]0", ",", "k", ",", "\[Alpha]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["detectorArea", 
        RowBox[{"photonSphereArea", "[", 
         RowBox[{"universe", ",", "z"}], "]"}]], 
       FractionBox[
        RowBox[{"2", "\[Eta]0"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", "\[Gamma]", "]"}], "\[Gamma]", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], ")"}], 
         RowBox[{"2", "-", "\[Alpha]"}]]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            FractionBox["\[Theta]", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"v", "[", "\[Gamma]", "]"}]], "-", "1", "+", 
                FractionBox[
                 SuperscriptBox["\[Theta]", "2"], "2"], "+", 
                FractionBox[
                 SuperscriptBox["\[Chi]", "2"], "2"], "-", 
                RowBox[{"\[Theta]", " ", "\[Chi]", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], 
              RowBox[{"5", "-", "\[Alpha]"}]]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Omega]2", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
              RowBox[{"i", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Omega]1", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"j", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Tau]2", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
              RowBox[{"j", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Tau]1", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", "\[Chi]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}], "+", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            FractionBox["\[Theta]", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"v", "[", "\[Gamma]", "]"}]], "-", "1", "+", 
                FractionBox[
                 SuperscriptBox["\[Theta]", "2"], "2"], "+", 
                FractionBox[
                 SuperscriptBox["\[Chi]", "2"], "2"], "-", 
                RowBox[{"\[Theta]", " ", "\[Chi]", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], 
              RowBox[{"5", "-", "\[Alpha]"}]]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Omega]2", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
              RowBox[{"i", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Omega]1", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"j", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Tau]2", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
              RowBox[{"j", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Tau]1", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "\[Chi]", ",", "\[Infinity]"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], 
        ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.589936126210228*^9, 3.589936343848271*^9}, {
   3.5899365248004932`*^9, 3.589936528423963*^9}, {3.58993662266119*^9, 
   3.589936723112678*^9}, {3.5900197488111343`*^9, 3.59001974973673*^9}, 
   3.590050095471758*^9, 3.590050486539094*^9, {3.590114285742614*^9, 
   3.590114286498996*^9}, {3.590114521530261*^9, 3.5901145344250193`*^9}, {
   3.59011520615725*^9, 3.590115206689993*^9}, {3.590149941571836*^9, 
   3.590149943201178*^9}, {3.590149986603722*^9, 3.590149989000428*^9}, {
   3.5901500700794363`*^9, 3.5901500895436783`*^9}, {3.5901501385787*^9, 
   3.590150168289069*^9}, {3.590150201255793*^9, 3.590150398428936*^9}, {
   3.5901504462695704`*^9, 3.590150494860758*^9}, {3.590150548359483*^9, 
   3.590150590355092*^9}, {3.590150649314307*^9, 3.590150653801833*^9}, {
   3.5901550508639717`*^9, 3.590155097406115*^9}, {3.590156130096141*^9, 
   3.590156132345707*^9}, 3.590156193276575*^9, {3.59015638237754*^9, 
   3.5901564310453663`*^9}, {3.5901565037737226`*^9, 3.59015654544372*^9}, {
   3.5901566143368607`*^9, 3.590156651142332*^9}, {3.590207713162766*^9, 
   3.590207737051004*^9}, {3.590317574136866*^9, 3.5903175972609167`*^9}, {
   3.590373496129187*^9, 3.5903734978963747`*^9}, {3.5903744495197573`*^9, 
   3.5903744553279057`*^9}, {3.590374487502187*^9, 3.59037449024564*^9}, {
   3.5903745212665243`*^9, 3.590374585319187*^9}, {3.590374638576312*^9, 
   3.590374689762074*^9}, {3.590374868885126*^9, 3.590374876528365*^9}, {
   3.5903749309309998`*^9, 3.590375003788867*^9}, {3.590376208418972*^9, 
   3.5903762223268757`*^9}, {3.590376436128688*^9, 3.590376438720146*^9}, {
   3.590376714901243*^9, 3.590376717275455*^9}, {3.590377340200777*^9, 
   3.590377359260088*^9}, {3.590657042830216*^9, 3.590657053196005*^9}, {
   3.5913255026474113`*^9, 3.5913255039982862`*^9}, {3.591859703943804*^9, 
   3.5918597128271503`*^9}, {3.592381967090205*^9, 3.5923819763930492`*^9}, {
   3.592382016207971*^9, 3.592382038939454*^9}, {3.59238286445877*^9, 
   3.592382867076763*^9}, {3.5923828989968767`*^9, 3.59238292101402*^9}, {
   3.592382953438415*^9, 3.592382962239151*^9}, {3.592383004420239*^9, 
   3.5923830331040373`*^9}, {3.592383251591423*^9, 3.5923833353095016`*^9}, 
   3.592383443406076*^9, {3.592383487291749*^9, 3.592383487974394*^9}, {
   3.592383557224546*^9, 3.592383586752921*^9}, {3.592383618532392*^9, 
   3.592383618684107*^9}, {3.592383666397189*^9, 3.592383693016754*^9}, {
   3.592384166008869*^9, 3.592384177647818*^9}, {3.592391068246366*^9, 
   3.5923910739578657`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Duration", "Subsection",
 CellChangeTimes->{{3.590061518520788*^9, 3.590061520245708*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "duration", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"part", "\[Rule]", "0.99"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"duration", "[", 
    RowBox[{"universe_", ",", "burst", ",", "observer", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1_", ",", "\[Omega]2_"}], "}"}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "burstValues", ",", "observerValues", ",", "p\[Infinity]", ",", 
       "precision"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"burstValues", "=", 
       RowBox[{"{", 
        RowBox[{
        "\[Gamma]", ",", "\[Eta]0", ",", "r0", ",", "n", ",", "\[Omega]0", 
         ",", "\[Theta]0", ",", "k", ",", "\[Alpha]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"observerValues", "=", 
       RowBox[{"{", 
        RowBox[{"detectorArea", ",", "z", ",", "\[Chi]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p\[Infinity]", "=", 
       RowBox[{"p", "[", 
        RowBox[{"universe", ",", "burstValues", ",", "observerValues", ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pi", "[", 
        RowBox[{"\[Tau]_", "?", "NumberQ"}], "]"}], ":=", 
       RowBox[{"p", "[", 
        RowBox[{"universe", ",", "burstValues", ",", "observerValues", ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "\[Tau]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Tau]", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "\[Tau]", "]"}], "-", 
          RowBox[{
           RowBox[{"OptionValue", "[", "part", "]"}], "p\[Infinity]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Tau]", ",", 
           RowBox[{
            FractionBox["r0", 
             SuperscriptBox["\[Gamma]", "2"]], 
            RowBox[{"(", 
             RowBox[{"1.", "+", "z"}], ")"}]}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5903178050646343`*^9, 3.590317829891816*^9}, {
   3.590325149911132*^9, 3.5903252239269533`*^9}, {3.590325262389987*^9, 
   3.5903252825737123`*^9}, {3.59032532930599*^9, 3.590325335424121*^9}, {
   3.590325462525869*^9, 3.590325478694022*^9}, {3.590325518676382*^9, 
   3.590325519188765*^9}, {3.590361415786047*^9, 3.590361488999978*^9}, 
   3.590365687436039*^9, {3.590373135594748*^9, 3.590373148844438*^9}, 
   3.5903762546660767`*^9, {3.590376451567272*^9, 3.59037645210378*^9}, {
   3.59037673199723*^9, 3.590376732180722*^9}, 3.590377306536478*^9, {
   3.590377574242556*^9, 3.59037759171872*^9}, {3.5903779197300177`*^9, 
   3.5903779352168922`*^9}, {3.590657083045203*^9, 3.590657088028907*^9}, {
   3.590657227680119*^9, 3.590657311788023*^9}, {3.591859728415344*^9, 
   3.591859736190181*^9}, {3.592131053761468*^9, 3.592131054093618*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stretching factor", "Subsection",
 CellChangeTimes->{{3.590042619518958*^9, 3.590042624004355*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"j\[Tau]", "[", 
    RowBox[{
    "burst", ",", "z_", ",", "\[Chi]_", ",", "\[Tau]_", ",", "\[Theta]_", ",",
      "\[Phi]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"\[Tau]", "\[Equal]", "\[Infinity]"}], ",", 
     "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
     FractionBox[
      SuperscriptBox["\[Tau]", "2"], 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"2", "\[Tau]"}], 
          RowBox[{"r0", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             FractionBox["2", 
              RowBox[{"v", "[", "\[Gamma]", "]"}]], "+", 
             SuperscriptBox["\[Theta]", "2"], "+", 
             SuperscriptBox["\[Chi]", "2"], "-", 
             RowBox[{"2", " ", "\[Theta]", " ", "\[Chi]", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}]}]], ")"}], 
        "n"]}]]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590028599043091*^9, 3.5900287132878847`*^9}, {
  3.591866391902088*^9, 3.591866402347027*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p\[Tau]", "[", 
    RowBox[{"universe_", ",", "burst", ",", "observer", ",", "\[Tau]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1_", ",", "\[Omega]2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "burstValues", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"burstValues", "=", 
       RowBox[{"{", 
        RowBox[{
        "\[Gamma]", ",", "\[Eta]0", ",", "r0", ",", "n", ",", "\[Omega]0", 
         ",", "\[Theta]0", ",", "k", ",", "\[Alpha]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["detectorArea", 
        RowBox[{"photonSphereArea", "[", 
         RowBox[{"universe", ",", "z"}], "]"}]], 
       FractionBox[
        RowBox[{"2", "\[Eta]0"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", "\[Gamma]", "]"}], "\[Gamma]", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}]}], ")"}], 
         RowBox[{"2", "-", "\[Alpha]"}]]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            FractionBox["\[Theta]", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"v", "[", "\[Gamma]", "]"}]], "-", "1", "+", 
                FractionBox[
                 SuperscriptBox["\[Theta]", "2"], "2"], "+", 
                FractionBox[
                 SuperscriptBox["\[Chi]", "2"], "2"], "-", 
                RowBox[{"\[Theta]", " ", "\[Chi]", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], 
              RowBox[{"5", "-", "\[Alpha]"}]]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Omega]2", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
              RowBox[{"i", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Omega]1", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}]}], ")"}], 
            RowBox[{"j\[Tau]", "[", 
             RowBox[{
             "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Tau]", ",", 
              "\[Theta]", ",", "\[Phi]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", "\[Chi]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}], "+", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            FractionBox["\[Theta]", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"v", "[", "\[Gamma]", "]"}]], "-", "1", "+", 
                FractionBox[
                 SuperscriptBox["\[Theta]", "2"], "2"], "+", 
                FractionBox[
                 SuperscriptBox["\[Chi]", "2"], "2"], "-", 
                RowBox[{"\[Theta]", " ", "\[Chi]", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], 
              RowBox[{"5", "-", "\[Alpha]"}]]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Omega]2", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
              RowBox[{"i", "[", 
               RowBox[{
               "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Omega]1", ",", 
                "\[Theta]", ",", "\[Phi]"}], "]"}]}], ")"}], 
            RowBox[{"j\[Tau]", "[", 
             RowBox[{
             "burstValues", ",", "z", ",", "\[Chi]", ",", "\[Tau]", ",", 
              "\[Theta]", ",", "\[Phi]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "\[Chi]", ",", "\[Infinity]"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], 
        ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.590028703917103*^9, 3.5900287422583*^9}, {
  3.590370562028707*^9, 3.5903705817073174`*^9}, {3.5903735131271887`*^9, 
  3.5903735149247704`*^9}, {3.59037625873454*^9, 3.590376269432321*^9}, {
  3.59037645631063*^9, 3.590376459198489*^9}, {3.59037673697011*^9, 
  3.5903767402335653`*^9}, {3.590377252491696*^9, 3.590377271844862*^9}, {
  3.591859747140493*^9, 3.591859755062467*^9}, {3.5923819391428547`*^9, 
  3.592381960737021*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "\[Kappa]", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]", "\[Rule]", "0.01"}], ",", 
     RowBox[{"accurateQ", "\[Rule]", "True"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]", "[", 
    RowBox[{"universe_", ",", "burst_", ",", "observer_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1_", ",", "\[Omega]2_", ",", "\[Omega]3_"}], "}"}], 
     ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p12\[Infinity]", ",", "p23\[Infinity]", ",", "diff", ",", "diff\[Tau]",
        ",", "\[Delta]\[Tau]", ",", "\[Tau]middle", ",", "\[Tau]end", ",", 
       "\[Kappa]min", ",", "\[Kappa]max", ",", "minDifference", ",", 
       "maxDifference", ",", "diffDifference", ",", "precision", ",", 
       "accQ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p12\[Infinity]", "=", 
       RowBox[{"p", "[", 
        RowBox[{"universe", ",", "burst", ",", "observer", ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p23\[Infinity]", "=", 
       RowBox[{"p", "[", 
        RowBox[{"universe", ",", "burst", ",", "observer", ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Omega]2", ",", "\[Omega]3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diff", "[", 
        RowBox[{
         RowBox[{"\[Tau]_", "?", "NumberQ"}], ",", 
         RowBox[{"\[Kappa]_", "?", "NumberQ"}]}], "]"}], ":=", 
       RowBox[{
        FractionBox[
         RowBox[{"p", "[", 
          RowBox[{"universe", ",", "burst", ",", "observer", ",", 
           RowBox[{"{", 
            RowBox[{"0.", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}], "]"}], 
         "p12\[Infinity]"], "-", 
        FractionBox[
         RowBox[{"p", "[", 
          RowBox[{"universe", ",", "burst", ",", "observer", ",", 
           RowBox[{"{", 
            RowBox[{"0.", ",", 
             RowBox[{"\[Kappa]", " ", "\[Tau]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]2", ",", "\[Omega]3"}], "}"}]}], "]"}], 
         "p23\[Infinity]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diff\[Tau]", "[", 
        RowBox[{
         RowBox[{"\[Tau]_", "?", "NumberQ"}], ",", 
         RowBox[{"\[Kappa]_", "?", "NumberQ"}]}], "]"}], ":=", 
       RowBox[{
        FractionBox[
         RowBox[{"p\[Tau]", "[", 
          RowBox[{
          "universe", ",", "burst", ",", "observer", ",", "\[Tau]", ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}], "]"}], 
         "p12\[Infinity]"], "-", 
        RowBox[{"\[Kappa]", " ", 
         FractionBox[
          RowBox[{"p\[Tau]", "[", 
           RowBox[{"universe", ",", "burst", ",", "observer", ",", 
            RowBox[{"\[Kappa]", " ", "\[Tau]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Omega]2", ",", "\[Omega]3"}], "}"}]}], "]"}], 
          "p23\[Infinity]"]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"accQ", "=", 
       RowBox[{"OptionValue", "[", "accurateQ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", "accQ", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]end", "=", 
          RowBox[{"duration", "[", 
           RowBox[{"universe", ",", "burst", ",", "observer", ",", 
            RowBox[{"{", 
             RowBox[{"\[Omega]1", ",", "\[Omega]3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Delta]\[Tau]", "=", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\[Delta]", "]"}], "\[Tau]end"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"maxDifference", "[", 
           RowBox[{"\[Kappa]_", "?", "NumberQ"}], "]"}], ":=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"zero", ",", "derivativeZero"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"diff", "[", 
                RowBox[{"\[Delta]\[Tau]", ",", "\[Kappa]"}], "]"}], ">", 
               "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"diff", "[", 
                   RowBox[{"\[Tau]end", ",", "\[Kappa]"}], "]"}], ">", "0"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"derivativeZero", "=", 
                   RowBox[{"\[Tau]", "/.", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"diff\[Tau]", "[", 
                    RowBox[{"\[Tau]", ",", "\[Kappa]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\[Tau]", ",", "\[Delta]\[Tau]", ",", "\[Tau]end"}], 
                    "}"}]}], "]"}]}]}], ";"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"zero", "=", 
                   RowBox[{"\[Tau]", "/.", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"diff", "[", 
                    RowBox[{"\[Tau]", ",", "\[Kappa]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\[Tau]", ",", "\[Delta]\[Tau]", ",", "\[Tau]end"}], 
                    "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"derivativeZero", "=", 
                   RowBox[{"\[Tau]", "/.", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"diff\[Tau]", "[", 
                    RowBox[{"\[Tau]", ",", "\[Kappa]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Tau]", ",", "\[Delta]\[Tau]", ",", 
                    RowBox[{"zero", "-", "\[Delta]\[Tau]"}]}], "}"}]}], 
                    "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"derivativeZero", ",", 
                 RowBox[{"diff", "[", 
                  RowBox[{"derivativeZero", ",", "\[Kappa]"}], "]"}]}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0."}], "}"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"minDifference", "[", 
           RowBox[{"\[Kappa]_", "?", "NumberQ"}], "]"}], ":=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"zero", ",", "derivativeZero"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"diff", "[", 
                RowBox[{"\[Delta]\[Tau]", ",", "\[Kappa]"}], "]"}], "<", 
               "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"derivativeZero", "=", 
                RowBox[{"\[Tau]", "/.", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{"diff\[Tau]", "[", 
                    RowBox[{"\[Tau]", ",", "\[Kappa]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "\[Tau]", ",", "\[Delta]\[Tau]", ",", "\[Tau]end"}], 
                    "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"derivativeZero", ",", 
                 RowBox[{"diff", "[", 
                  RowBox[{"derivativeZero", ",", "\[Kappa]"}], "]"}]}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"diff", "[", 
                  RowBox[{"\[Tau]end", ",", "\[Kappa]"}], "]"}], "<", "0"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"zero", "=", 
                  RowBox[{"\[Tau]", "/.", 
                   RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"diff", "[", 
                    RowBox[{"\[Tau]", ",", "\[Kappa]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\[Tau]", ",", "\[Delta]\[Tau]", ",", "\[Tau]end"}], 
                    "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"derivativeZero", "=", 
                  RowBox[{"\[Tau]", "/.", 
                   RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"diff\[Tau]", "[", 
                    RowBox[{"\[Tau]", ",", "\[Kappa]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Tau]", ",", 
                    RowBox[{"zero", "+", "\[Delta]\[Tau]"}], ",", 
                    "\[Tau]end"}], "}"}]}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"derivativeZero", ",", 
                   RowBox[{"diff", "[", 
                    RowBox[{"derivativeZero", ",", "\[Kappa]"}], "]"}]}], 
                  "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"0.", ",", "0."}], "}"}]}], "\[IndentingNewLine]", 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Kappa]min", "=", 
          RowBox[{"\[Kappa]i", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{"diff", "[", 
              RowBox[{"\[Delta]\[Tau]", ",", "\[Kappa]i"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Kappa]i", ",", "1."}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Kappa]max", "=", 
          RowBox[{"\[Kappa]i", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{"diff", "[", 
              RowBox[{"\[Tau]end", ",", "\[Kappa]i"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Kappa]i", ",", "1."}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"diffDifference", "[", 
           RowBox[{"\[Kappa]_", "?", "NumberQ"}], "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"maxDifference", "[", "\[Kappa]", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"minDifference", "[", "\[Kappa]", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Kappa]i", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"diffDifference", "[", "\[Kappa]i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Kappa]i", ",", "\[Kappa]min", ",", "\[Kappa]max"}], 
             "}"}]}], "]"}]}]}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]middle", "=", 
          RowBox[{"duration", "[", 
           RowBox[{"universe", ",", "burst", ",", "observer", ",", 
            RowBox[{"{", 
             RowBox[{"\[Omega]1", ",", "\[Omega]3"}], "}"}], ",", 
            RowBox[{"part", "\[Rule]", "0.5"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Kappa]i", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"diff", "[", 
             RowBox[{"\[Tau]middle", ",", "\[Kappa]i"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Kappa]i", ",", "1."}], "}"}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5903265796208687`*^9, 3.590326833677573*^9}, {
   3.5903269327331257`*^9, 3.5903269503094893`*^9}, {3.590326987903431*^9, 
   3.5903271369707203`*^9}, {3.590327176239778*^9, 3.590327185314533*^9}, {
   3.5903272680607367`*^9, 3.590327271219748*^9}, {3.590327312586216*^9, 
   3.590327315351831*^9}, {3.590327388496572*^9, 3.590327480915551*^9}, {
   3.59032751419615*^9, 3.5903275248632917`*^9}, {3.590327561137848*^9, 
   3.590327564923519*^9}, {3.590327640238681*^9, 3.590327677067874*^9}, {
   3.590327813182415*^9, 3.590327828205284*^9}, {3.590328354366934*^9, 
   3.590328555755969*^9}, {3.5903286431336727`*^9, 3.590328659784225*^9}, 
   3.59032872295754*^9, {3.590329189043144*^9, 3.590329189722125*^9}, {
   3.5903650237753553`*^9, 3.5903651970818777`*^9}, {3.590365259406893*^9, 
   3.590365267195998*^9}, {3.5903654226609497`*^9, 3.590365456892521*^9}, {
   3.590365501664783*^9, 3.590365503984386*^9}, {3.590365568175743*^9, 
   3.590365573478949*^9}, {3.590365618227973*^9, 3.590365621461379*^9}, {
   3.5903657229232492`*^9, 3.59036572479393*^9}, {3.59036577981052*^9, 
   3.590365782180976*^9}, {3.5903659951005793`*^9, 3.590366003108227*^9}, {
   3.590366051467641*^9, 3.590366283475524*^9}, {3.590366406272266*^9, 
   3.5903664222486973`*^9}, {3.590366532280233*^9, 3.590366560568139*^9}, 
   3.590366612775997*^9, {3.5903666531368933`*^9, 3.5903666533696127`*^9}, {
   3.5903704326686993`*^9, 3.590370533346634*^9}, {3.5903705920432377`*^9, 
   3.590370715562079*^9}, {3.590370746441658*^9, 3.590371170661167*^9}, 
   3.590371248583733*^9, {3.590371412755732*^9, 3.590371549940089*^9}, {
   3.590371605026496*^9, 3.590371622782262*^9}, {3.590371724324032*^9, 
   3.590371738661891*^9}, {3.590372125774158*^9, 3.5903721789825907`*^9}, {
   3.590372659458366*^9, 3.590372660732067*^9}, {3.590372841198977*^9, 
   3.590372848830831*^9}, {3.590372949274189*^9, 3.590372954958375*^9}, {
   3.5903730718440933`*^9, 3.590373074450584*^9}, {3.590373162138679*^9, 
   3.590373164754616*^9}, {3.5903732574823713`*^9, 3.590373257613722*^9}, {
   3.590373332784211*^9, 3.5903733329269667`*^9}, {3.59037341674111*^9, 
   3.5903734194048243`*^9}, {3.590375379521632*^9, 3.590375382490905*^9}, {
   3.590375428952099*^9, 3.5903755736247063`*^9}, {3.590375724661763*^9, 
   3.590375782583375*^9}, {3.5903759191691513`*^9, 3.590375927059924*^9}, {
   3.5903760199509783`*^9, 3.590376024215468*^9}, {3.5903762774287863`*^9, 
   3.590376313791407*^9}, {3.590376464702487*^9, 3.590376489807502*^9}, {
   3.5903767460743427`*^9, 3.590376773731325*^9}, {3.590377131337274*^9, 
   3.59037721201258*^9}, {3.590377415812442*^9, 3.5903774737943296`*^9}, {
   3.590377527059918*^9, 3.590377533724476*^9}, {3.5903776145091867`*^9, 
   3.590377672534587*^9}, {3.5903778454072237`*^9, 3.590377882622674*^9}, {
   3.590381758973577*^9, 3.590381812886834*^9}, {3.5903873864196987`*^9, 
   3.590387458002425*^9}, {3.590387510659731*^9, 3.590387543611752*^9}, {
   3.59038758612471*^9, 3.590387621217507*^9}, {3.590388552680749*^9, 
   3.5903885528275633`*^9}, {3.59065748233827*^9, 3.590657557181745*^9}, {
   3.590657618614839*^9, 3.590657683718027*^9}, {3.590716042223925*^9, 
   3.59071604340497*^9}, {3.5907163929288683`*^9, 3.590716396686603*^9}, {
   3.590716711520685*^9, 3.590716712288282*^9}, {3.591859766023552*^9, 
   3.591859821493609*^9}, {3.59213105995527*^9, 3.592131060311899*^9}, {
   3.5939055257237873`*^9, 3.593905551360847*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetSharedFunction", "[", "\[Kappa]StoredValues", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "\[Kappa]Cache", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]", "\[Rule]", "0.01"}], ",", 
     RowBox[{"accurateQ", "\[Rule]", "True"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]Cache", "[", 
    RowBox[{"universe_", ",", "burst_", ",", "observer_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1_", ",", "\[Omega]2_", ",", "\[Omega]3_"}], "}"}], 
     ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"NumberQ", "[", 
          RowBox[{"\[Kappa]StoredValues", "[", 
           RowBox[{"universe", ",", "burst", ",", "observer", ",", 
            RowBox[{"{", 
             RowBox[{"\[Omega]1", ",", "\[Omega]2", ",", "\[Omega]3"}], "}"}],
             ",", 
            RowBox[{"OptionValue", "[", "\[Delta]", "]"}], ",", 
            RowBox[{"OptionValue", "[", "accurateQ", "]"}]}], "]"}], "]"}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{"\[Kappa]StoredValues", "[", 
          RowBox[{"universe", ",", "burst", ",", "observer", ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", "\[Omega]2", ",", "\[Omega]3"}], "}"}], 
           ",", 
           RowBox[{"OptionValue", "[", "\[Delta]", "]"}], ",", 
           RowBox[{"OptionValue", "[", "accurateQ", "]"}]}], "]"}], "=", 
         RowBox[{"\[Kappa]", "[", 
          RowBox[{"universe", ",", "burst", ",", "observer", ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]1", ",", "\[Omega]2", ",", "\[Omega]3"}], "}"}], 
           ",", 
           RowBox[{"\[Delta]", "\[Rule]", 
            RowBox[{"OptionValue", "[", "\[Delta]", "]"}]}], ",", 
           RowBox[{"accurateQ", "\[Rule]", 
            RowBox[{"OptionValue", "[", "accurateQ", "]"}]}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]StoredValues", "[", 
       RowBox[{"universe", ",", "burst", ",", "observer", ",", 
        RowBox[{"{", 
         RowBox[{"\[Omega]1", ",", "\[Omega]2", ",", "\[Omega]3"}], "}"}], 
        ",", 
        RowBox[{"OptionValue", "[", "\[Delta]", "]"}], ",", 
        RowBox[{"OptionValue", "[", "accurateQ", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592528888258531*^9, 3.592528925623564*^9}, {
  3.592528988974207*^9, 3.5925290002608213`*^9}, {3.592529049108858*^9, 
  3.592529120243537*^9}, {3.5925291986387*^9, 3.592529265749548*^9}, {
  3.592529563339875*^9, 3.592529584373616*^9}, {3.593873234597978*^9, 
  3.593873237272119*^9}, {3.593905698912496*^9, 3.593905700841269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]Save", "[", "]"}], ":=", 
   RowBox[{"DumpSave", "[", 
    RowBox[{"\"\<kappa.mx\>\"", ",", "\[Kappa]StoredValues"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.592529329018914*^9, 3.592529388830374*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]Load", "[", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "\"\<kappa.mx\>\"", "]"}], ",", 
     RowBox[{"<<", "\"\<kappa.mx\>\""}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5925294093082523`*^9, 3.592529422202147*^9}, {
  3.592529859852643*^9, 3.592529879288867*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total Energy", "Subsection",
 CellChangeTimes->{{3.591179569287243*^9, 3.5911795710461187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"energy", "[", 
    RowBox[{"burst", ",", "\[Omega]1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"16", 
      SuperscriptBox["\[Pi]", "3"]}], 
     RowBox[{"3", "n", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "k"}], "-", "\[Alpha]", "-", "2"}], ")"}], 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"3", "\[Pi]"}], "n"], "]"}]}]], 
    SuperscriptBox["\[Gamma]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], "k"}], "-", "\[Alpha]"}]], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["1", 
       RowBox[{"4", 
        SuperscriptBox["\[Gamma]", "2"]}]]}], ")"}], "\[Eta]0", " ", 
    SuperscriptBox["r0", "3"], 
    SuperscriptBox["\[Theta]0", "2"], 
    FractionBox[
     SuperscriptBox["\[Omega]0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "k"}], "-", "\[Alpha]"}]], 
     SuperscriptBox["\[Omega]1", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "k"}], "-", "\[Alpha]", "-", "2"}]]]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.591267384750402*^9, 3.591267391974464*^9}, {
  3.591267431626403*^9, 3.5912674907454443`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Distribution", "Subsection",
 CellChangeTimes->{{3.592129665485837*^9, 3.592129667602376*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "zmax", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"minParticles", "\[Rule]", "10"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zmax", "[", 
    RowBox[{
    "universe_", ",", "burst_", ",", "detectorArea_", ",", "\[Chi]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1_", ",", "\[Omega]2_"}], "}"}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"int", ",", "z1", ",", "z2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"int", "[", 
        RowBox[{"z_", "?", "NumberQ"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"universe", ",", "burst", ",", 
          RowBox[{"{", 
           RowBox[{"detectorArea", ",", "z", ",", "\[Chi]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "\[Infinity]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}], "]"}], "-", 
        RowBox[{"OptionValue", "[", "minParticles", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z1", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"int", "[", "z1", "]"}], "<", "0"}], ",", 
        RowBox[{"z1", "/=", "2."}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"z2", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"int", "[", "z2", "]"}], ">", "0"}], ",", 
        RowBox[{"z2", "*=", "2."}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"z", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{"int", "[", "z", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "z1", ",", "z2"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5921304966002817`*^9, 3.592130552109898*^9}, {
  3.592130602992848*^9, 3.592130674463716*^9}, {3.5921308289039383`*^9, 
  3.592130919923584*^9}, {3.592130993209762*^9, 3.592131036607246*^9}, {
  3.592131068302374*^9, 3.592131114338842*^9}, {3.592187459284543*^9, 
  3.592187463651868*^9}, {3.5921894029246273`*^9, 3.592189416673624*^9}, {
  3.592189472174855*^9, 3.592189474840663*^9}, {3.592189512887924*^9, 
  3.5921895587398148`*^9}, {3.5921896539432096`*^9, 3.592189655743219*^9}, {
  3.5921897207067432`*^9, 3.592189792248406*^9}, {3.592523268807684*^9, 
  3.592523277638463*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "\[Chi]max", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"minParticles", "\[Rule]", "10"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]max", "[", 
    RowBox[{"universe_", ",", "burst", ",", "detectorArea_", ",", "z_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1_", ",", "\[Omega]2_"}], "}"}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"burstValues", ",", "int", ",", "\[Chi]0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"burstValues", "=", 
       RowBox[{"{", 
        RowBox[{
        "\[Gamma]", ",", "\[Eta]0", ",", "r0", ",", "n", ",", "\[Omega]0", 
         ",", "\[Theta]0", ",", "k", ",", "\[Alpha]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"int", "[", 
        RowBox[{"\[Chi]_", "?", "NumberQ"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"universe", ",", "burstValues", ",", 
          RowBox[{"{", 
           RowBox[{"detectorArea", ",", "z", ",", "\[Chi]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "\[Infinity]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Omega]1", ",", "\[Omega]2"}], "}"}]}], "]"}], "-", 
        RowBox[{"OptionValue", "[", "minParticles", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"int", "[", "0", "]"}], "<", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Chi]0", "=", 
          FractionBox["1", "\[Gamma]"]}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"int", "[", "\[Chi]0", "]"}], ">", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Chi]0", "*=", "2."}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Chi]", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{"int", "[", "\[Chi]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Chi]", ",", "0", ",", "\[Chi]0"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5921857052057743`*^9, 3.592185803579471*^9}, {
   3.59218608379284*^9, 3.592186084456647*^9}, {3.592186118768695*^9, 
   3.5921861369850273`*^9}, {3.592186279322113*^9, 3.592186283263797*^9}, {
   3.592186408819564*^9, 3.592186409833569*^9}, {3.592186514998681*^9, 
   3.5921865161561813`*^9}, {3.592186549874604*^9, 3.592186550490327*^9}, {
   3.592186845398295*^9, 3.592186871706634*^9}, {3.592186905081287*^9, 
   3.592186988885932*^9}, {3.592187058690855*^9, 3.5921870590983143`*^9}, 
   3.592189794467548*^9, {3.592523272494398*^9, 3.592523283652163*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"burstDensity", "[", 
    RowBox[{"population", ",", "z_"}], "]"}], ":=", 
   RowBox[{"density0", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "z"}], ")"}], "index"], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      FractionBox["z", "zc"]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5856137215181513`*^9, 3.585613732106592*^9}, {
  3.5856139108435183`*^9, 3.585613914751878*^9}, {3.585613970434301*^9, 
  3.585613975955866*^9}, {3.585614006163372*^9, 3.585614030084044*^9}, {
  3.586064013498889*^9, 3.586064020618878*^9}, {3.5860640700328197`*^9, 
  3.586064086192721*^9}, {3.5860641284860764`*^9, 3.586064134581768*^9}, {
  3.586067617826783*^9, 3.5860676238822393`*^9}, {3.586084016960991*^9, 
  3.586084058159371*^9}, {3.5860841349582148`*^9, 3.586084154055051*^9}, {
  3.592195778970891*^9, 3.59219584478927*^9}, {3.592200474175756*^9, 
  3.592200496437546*^9}, {3.592532263911756*^9, 3.592532264849284*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phaseVolume", "[", 
    RowBox[{"universe_", ",", "population_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z1_", "?", "NumberQ"}], ",", 
       RowBox[{"z2_", "?", "NumberQ"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"shellVolumePerRedshift", "[", 
       RowBox[{"universe", ",", "z"}], "]"}], 
      RowBox[{"burstDensity", "[", 
       RowBox[{"population", ",", "z"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "z1", ",", "z2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5925456326017933`*^9, 3.592545732196768*^9}, {
   3.592545783538019*^9, 3.592545786773512*^9}, {3.592546012556716*^9, 
   3.592546018044792*^9}, {3.593840399592741*^9, 3.593840416703673*^9}, {
   3.5938404598645267`*^9, 3.593840516220233*^9}, {3.593840547309245*^9, 
   3.593840557819276*^9}, {3.593840595878455*^9, 3.593840629211656*^9}, 
   3.593848457587241*^9, {3.593848504424852*^9, 3.593848527916236*^9}, {
   3.593848570125452*^9, 3.593848578108759*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"randomRedshift", "[", 
    RowBox[{"universe_", ",", "population_", ",", 
     RowBox[{"{", 
      RowBox[{"z1_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"total", ",", "chosenVolume"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"total", "=", 
       RowBox[{"phaseVolume", "[", 
        RowBox[{"universe", ",", "population", ",", 
         RowBox[{"{", 
          RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chosenVolume", "=", 
       RowBox[{"RandomReal", "[", "total", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"phaseVolume", "[", 
           RowBox[{"universe", ",", "population", ",", 
            RowBox[{"{", 
             RowBox[{"z1", ",", "z"}], "}"}]}], "]"}], "-", "chosenVolume"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "z1", ",", "z2"}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59383960775867*^9, 3.593839708028894*^9}, {
  3.593839760856065*^9, 3.59383978528448*^9}, {3.593839919312972*^9, 
  3.593839927982379*^9}, {3.5938399605789957`*^9, 3.59383998061572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"randomAngle", "[", 
    RowBox[{"{", 
     RowBox[{"\[Chi]1_", ",", "\[Chi]2_"}], "}"}], "]"}], ":=", 
   SqrtBox[
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["\[Chi]1", "2"], ",", 
       SuperscriptBox["\[Chi]2", "2"]}], "}"}], "]"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.593839870415963*^9, 3.593839884885872*^9}, {
  3.593839988050838*^9, 3.593840005353404*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "\[Kappa]Sample", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"accurateQ", "\[Rule]", "True"}], ",", 
     RowBox[{"randomSeed", "\[Rule]", "\"\<Gamma Rays\>\""}], ",", 
     RowBox[{"zmin", "\[Rule]", "0.1"}], ",", 
     RowBox[{"minParticles", "\[Rule]", "10"}], ",", 
     RowBox[{"monitorQ", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]Sample", "[", 
    RowBox[{
    "universe_", ",", "population_", ",", "burst_", ",", "detectorArea_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1_", ",", "\[Omega]2_", ",", "\[Omega]3_"}], "}"}], 
     ",", "n_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "z2", ",", "\[Chi]2", ",", "it", ",", "zc", ",", "\[Chi]c", ",", 
       "pointsChosen", ",", "pointsStarted", ",", "pointsCompleted", ",", 
       "result", ",", "region", ",", "\[Kappa]Values", ",", "cur\[Kappa]", 
       ",", "\[IndentingNewLine]", "text", ",", "plot2D", ",", "plot3D", ",", 
       "plotCDF", ",", "print"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SeedRandom", "[", 
       RowBox[{"OptionValue", "[", "randomSeed", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "pointsStarted", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "pointsCompleted", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "\[Kappa]Values", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pointsChosen", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pointsStarted", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pointsCompleted", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Values", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"region", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"it", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "monitorQ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"print", "=", 
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"text", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"it", "\[Equal]", "0"}], ",", "\"\<initializing\>\"", 
               ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "pointsStarted", "]"}], ">", "0"}], 
                 ",", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{"Length", "[", "pointsCompleted", "]"}], "]"}], 
                  "<>", "\"\</\>\"", "<>", 
                  RowBox[{"ToString", "[", "n", "]"}], "<>", 
                  "\"\< \[Kappa] values computed\>\""}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{"Length", "[", "pointsChosen", "]"}], "]"}], "<>", 
                  "\"\</\>\"", "<>", 
                  RowBox[{"ToString", "[", "n", "]"}], "<>", 
                  "\"\< points chosen\>\""}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"plot2D", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"it", "\[Equal]", "0"}], ",", 
               "\"\<[2D plot will be here]\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"Show", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"RegionPlot", "[", 
                  RowBox[{"region", ",", 
                   RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"OptionValue", "[", "zmin", "]"}], ",", "z2"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Chi]", ",", "0", ",", "\[Chi]2"}], "}"}], ",", 
                   
                   RowBox[{"PlotStyle", "\[Rule]", "LightRed"}]}], "]"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"ListPlot", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pointsChosen", "/.", 
                    RowBox[{
                    RowBox[{"{", "}"}], "\[Rule]", "Missing"}]}], ",", 
                    RowBox[{"pointsStarted", "/.", 
                    RowBox[{
                    RowBox[{"{", "}"}], "\[Rule]", "Missing"}]}], ",", 
                    RowBox[{"pointsCompleted", "/.", 
                    RowBox[{
                    RowBox[{"{", "}"}], "\[Rule]", "Missing"}]}]}], "}"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", "Red", ",", "Green"}], "}"}]}]}], 
                  "]"}]}], "\[IndentingNewLine]", "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"plot3D", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "\[Kappa]Values", "]"}], 
                "\[GreaterEqual]", "6"}], ",", "\[IndentingNewLine]", 
               RowBox[{"ListPointPlot3D", "[", 
                RowBox[{"\[Kappa]Values", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "zmin", "]"}], ",", "z2"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\[Chi]2"}], "}"}], ",", "Full"}], 
                   "}"}]}], ",", 
                 RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               "\"\<[3D plot will be here]\>\""}], "\[IndentingNewLine]", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"plotCDF", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "pointsCompleted", "]"}], ">", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{"CDF", "[", 
                  RowBox[{
                   RowBox[{"EmpiricalDistribution", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "\[Kappa]Values", "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\[Kappa]i"}],
                   "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Kappa]i", ",", "0", ",", 
                   RowBox[{"1.2", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "\[Kappa]Values", "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "}"}]}], "]"}],
                ",", "\[IndentingNewLine]", "\"\<[cdf will be here]\>\""}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Grid", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "text", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"plot2D", ",", "plot3D", ",", "plotCDF"}], "}"}]}], 
              "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"z2", "=", 
       RowBox[{"zmax", "[", 
        RowBox[{
        "universe", ",", "burst", ",", "detectorArea", ",", "0", ",", 
         RowBox[{"{", 
          RowBox[{"\[Omega]2", ",", "\[Omega]3"}], "}"}], ",", 
         RowBox[{"minParticles", "\[Rule]", 
          RowBox[{"OptionValue", "[", "minParticles", "]"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"\[Chi]2", "=", 
       RowBox[{"\[Chi]max", "[", 
        RowBox[{"universe", ",", "burst", ",", "detectorArea", ",", 
         RowBox[{"OptionValue", "[", "zmin", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Omega]2", ",", "\[Omega]3"}], "}"}], ",", 
         RowBox[{"minParticles", "\[Rule]", 
          RowBox[{"OptionValue", "[", "minParticles", "]"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"it", "=", "1"}], ",", 
        RowBox[{"it", "\[LessEqual]", "n"}], ",", 
        RowBox[{"it", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"zc", "=", 
          RowBox[{"randomRedshift", "[", 
           RowBox[{"universe", ",", "population", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"OptionValue", "[", "zmin", "]"}], ",", "z2"}], "}"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Chi]c", "=", 
          RowBox[{"randomAngle", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Chi]2"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"region", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"z", "\[Rule]", "zc"}], ",", 
              RowBox[{"\[Chi]", "\[Rule]", "\[Chi]c"}]}], "}"}]}], ",", 
           RowBox[{"it", "--"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"universe", ",", "burst", ",", 
                 RowBox[{"{", 
                  RowBox[{"detectorArea", ",", "zc", ",", "\[Chi]c"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "\[Infinity]"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Omega]2", ",", "\[Omega]3"}], "}"}]}], "]"}], 
               "\[GreaterEqual]", "10."}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"pointsChosen", ",", 
                 RowBox[{"{", 
                  RowBox[{"zc", ",", "\[Chi]c"}], "}"}]}], "]"}], ";"}], 
              "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"region", "=", 
                RowBox[{"region", "||", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"z", ">", "zc"}], "&&", 
                   RowBox[{"\[Chi]", ">", "\[Chi]c"}]}], ")"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"it", "--"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Load", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"pointsStarted", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"point", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"point", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cur\[Kappa]", "=", 
           RowBox[{"\[Kappa]Cache", "[", 
            RowBox[{"universe", ",", "burst", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"detectorArea", ",", "point"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Omega]1", ",", "\[Omega]2", ",", "\[Omega]3"}], 
              "}"}], ",", 
             RowBox[{"accurateQ", "\[Rule]", 
              RowBox[{"OptionValue", "[", "accurateQ", "]"}]}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"pointsCompleted", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"point", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"point", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"\[Kappa]Values", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"point", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"point", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "cur\[Kappa]"}], "}"}]}], 
           "]"}], ";", "\[IndentingNewLine]", "cur\[Kappa]"}], ",", 
         RowBox[{"{", 
          RowBox[{"point", ",", "pointsChosen"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]Save", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "monitorQ", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NotebookDelete", "[", "print", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"UnsetShared", "[", "pointsStarted", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UnsetShared", "[", "pointsCompleted", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UnsetShared", "[", "\[Kappa]Values", "]"}], ";", 
      "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.593829498556116*^9, 3.59382957225982*^9}, {
   3.5938296333935223`*^9, 3.593829650765555*^9}, {3.593829729257169*^9, 
   3.593829863830003*^9}, {3.593829948353723*^9, 3.593829985930216*^9}, {
   3.593830314555534*^9, 3.593830316568328*^9}, {3.5938303955295*^9, 
   3.593830399255043*^9}, {3.593830452558757*^9, 3.593830479748863*^9}, {
   3.5938305606191387`*^9, 3.5938305701919413`*^9}, {3.593830632818996*^9, 
   3.59383063481174*^9}, {3.593830687683269*^9, 3.593830688337278*^9}, {
   3.593840096425436*^9, 3.593840294326721*^9}, {3.593848682486663*^9, 
   3.593849078274324*^9}, {3.59384921744659*^9, 3.5938492199572487`*^9}, {
   3.593849480530299*^9, 3.5938494812775173`*^9}, {3.593849994974738*^9, 
   3.5938499988794203`*^9}, {3.593850079391433*^9, 3.5938501227850237`*^9}, {
   3.593850166907522*^9, 3.593850205496826*^9}, {3.593850267425778*^9, 
   3.59385026855984*^9}, {3.59385038777316*^9, 3.593850400141574*^9}, {
   3.593850674796912*^9, 3.5938507684263363`*^9}, {3.5938508324764757`*^9, 
   3.5938508378329277`*^9}, {3.593851094453013*^9, 3.593851163360837*^9}, {
   3.5938512097529707`*^9, 3.593851230453968*^9}, {3.593851260561194*^9, 
   3.5938513794818287`*^9}, {3.59385141893301*^9, 3.593851437851431*^9}, {
   3.593851490277545*^9, 3.593851504700981*^9}, {3.593851627426011*^9, 
   3.5938516293756237`*^9}, {3.593851667865361*^9, 3.5938517376806107`*^9}, {
   3.593851781761018*^9, 3.593851888733378*^9}, {3.593852616644332*^9, 
   3.593852617341557*^9}, {3.593852672820776*^9, 3.593852673697074*^9}, {
   3.593852708643248*^9, 3.593852820131774*^9}, {3.5938528589407587`*^9, 
   3.5938528736718283`*^9}, {3.593852903771212*^9, 3.593852906251026*^9}, {
   3.593852942052574*^9, 3.593852946865549*^9}, {3.593853026757545*^9, 
   3.59385313091962*^9}, {3.593853278451165*^9, 3.593853280586754*^9}, {
   3.593853667365419*^9, 3.593853669087388*^9}, {3.5938538857049637`*^9, 
   3.5938538873035994`*^9}, {3.593853938550721*^9, 3.593854041746407*^9}, {
   3.5938540875196657`*^9, 3.593854165869815*^9}, {3.593854195921035*^9, 
   3.5938541990335493`*^9}, {3.593854361548442*^9, 3.593854364134231*^9}, {
   3.593854408187831*^9, 3.5938544125677643`*^9}, {3.5938549516104097`*^9, 
   3.593855176998748*^9}, {3.593855275949841*^9, 3.5938556801370163`*^9}, {
   3.5938557759104443`*^9, 3.5938557792154713`*^9}, {3.593855856547268*^9, 
   3.593855863202734*^9}, {3.593855962358906*^9, 3.593855978342469*^9}, {
   3.593856142902267*^9, 3.593856168329731*^9}, {3.593856344608197*^9, 
   3.593856598244113*^9}, {3.5938567970207977`*^9, 3.593856798435618*^9}, {
   3.593857031649642*^9, 3.593857036411066*^9}, {3.593857507823163*^9, 
   3.5938576089383163`*^9}, {3.59385774283605*^9, 3.59385777425835*^9}, {
   3.593857846063458*^9, 3.593857881334984*^9}, {3.593858053047345*^9, 
   3.593858053673588*^9}, {3.593858278536469*^9, 3.593858288350581*^9}, {
   3.593858452577668*^9, 3.5938585083963346`*^9}, {3.593858854559525*^9, 
   3.5938588554624653`*^9}, {3.593859279347118*^9, 3.5938593385557127`*^9}, {
   3.5938593914195547`*^9, 3.5938594430331*^9}, {3.59385950945266*^9, 
   3.593859567259824*^9}, {3.593859602970642*^9, 3.5938596883596077`*^9}, {
   3.5938597287427473`*^9, 3.593859728986142*^9}, {3.593859766702186*^9, 
   3.593859866714752*^9}, {3.593859964886874*^9, 3.593859996293497*^9}, {
   3.593860101255541*^9, 3.59386010637991*^9}, {3.593860350639338*^9, 
   3.593860515294915*^9}, {3.593860582282308*^9, 3.593860635507045*^9}, 
   3.593860673784154*^9, 3.593860704901205*^9, {3.593860747327465*^9, 
   3.593860808162122*^9}, {3.593860846071422*^9, 3.593860848420909*^9}, {
   3.593861089471142*^9, 3.59386122742484*^9}, {3.593861367306939*^9, 
   3.593861515*^9}, {3.593861555385614*^9, 3.5938615767901173`*^9}, {
   3.593861679387744*^9, 3.5938618316938353`*^9}, {3.593861882455223*^9, 
   3.593862076897107*^9}, {3.593862112771475*^9, 3.5938621474337683`*^9}, {
   3.593862485061495*^9, 3.593862488326621*^9}, {3.59386277888704*^9, 
   3.593862783850854*^9}, {3.593869705876305*^9, 3.593869707234949*^9}, {
   3.59390536864774*^9, 3.593905371038904*^9}, {3.593905570502734*^9, 
   3.593905571028948*^9}, {3.5939057263620462`*^9, 3.5939057346045837`*^9}, {
   3.593905792263921*^9, 3.593905792800541*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mcData", "=", 
   RowBox[{"\[Kappa]Sample", "[", 
    RowBox[{
     RowBox[{"defaultUniverse", "[", "]"}], ",", 
     RowBox[{"defaultPopulation", "[", "]"}], ",", 
     RowBox[{"defaultBurst", "[", "]"}], ",", 
     RowBox[{"defaultDetectorArea", "[", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "1.", ",", "\[Infinity]"}], "}"}], ",", "10", ",", 
     RowBox[{"monitorQ", "\[Rule]", "True"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.593849081306847*^9, 3.593849085146221*^9}, {
   3.593849164584427*^9, 3.59384918646242*^9}, {3.593849337599516*^9, 
   3.5938493422998857`*^9}, {3.593849947405909*^9, 3.593849951101193*^9}, {
   3.5938502819832983`*^9, 3.593850284262919*^9}, {3.593851906368334*^9, 
   3.5938519238632812`*^9}, {3.593855191049335*^9, 3.5938552066526937`*^9}, {
   3.5938557947740917`*^9, 3.593855823857747*^9}, {3.59385619862838*^9, 
   3.5938561987149973`*^9}, {3.593856775979611*^9, 3.59385680932089*^9}, {
   3.5938576205756903`*^9, 3.593857620889922*^9}, {3.593858291928344*^9, 
   3.593858293496048*^9}, {3.593858861719535*^9, 3.593858862017633*^9}, {
   3.593859711665759*^9, 3.593859712134449*^9}, {3.593862441570022*^9, 
   3.593862462440938*^9}, 3.5938625439009647`*^9, {3.593862588010263*^9, 
   3.593862588301011*^9}, 3.593862625384758*^9, {3.593862795420339*^9, 
   3.5938627968340893`*^9}, {3.593862893032681*^9, 3.593862896845901*^9}, 
   3.593869949385469*^9, 3.593873008506753*^9, {3.5938733079107513`*^9, 
   3.593873308029427*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical integration converging too slowly; suspect one \
of the following: singularity, value of the integration is 0, highly \
oscillatory integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.5939056077764673`*^9, {3.593905786240808*^9, 3.593905799784734*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical integration converging too slowly; suspect one \
of the following: singularity, value of the integration is 0, highly \
oscillatory integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.5939056077764673`*^9, {3.593905786240808*^9, 3.5939058004098673`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical integration converging too slowly; suspect one \
of the following: singularity, value of the integration is 0, highly \
oscillatory integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.5939056077764673`*^9, {3.593905786240808*^9, 3.593905811232366*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(NIntegrate :: slwcon\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.5939056077764673`*^9, {3.593905786240808*^9, 3.593905811286281*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.5938731532763357`*^9, 3.593873403343419*^9, 
  3.593905454503187*^9, 3.593905575179686*^9, 3.59390567239894*^9, 
  3.593905789513459*^9, 3.593905855394929*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"EmpiricalDistribution", "[", "mcData", "]"}], ",", 
     "\[Kappa]i"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Kappa]i", ",", 
     RowBox[{"Min", "[", "mcData", "]"}], ",", 
     RowBox[{"Max", "[", "mcData", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5938626945737457`*^9, 3.593862716373858*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {Hue[0.67, 0.6, 0.6], 
     LineBox[{{0.8669929734941703, 0.01}, {0.8706739337737486, 0.01}, {
      0.8743548940533268, 0.01}, {0.8761953741931159, 0.01}, {
      0.8780358543329051, 0.01}, {0.8789560944027996, 0.01}, {
      0.8798763344726943, 0.01}, {0.8800292629475751, 0.01}}], 
     LineBox[{{0.9258883379674229, 0.07}, {0.9268859836543406, 0.07}, {
      0.927403501583569, 0.07}}], 
     LineBox[{{0.9905678996183047, 0.22000000000000006`}, {0.9934637955190396,
       0.22000000000000006`}, {0.9971899291079176, 0.22000000000000006`}, {
      0.9990529959023565, 0.22000000000000006`}, {1.0006953317887375`, 
      0.22000000000000006`}}], 
     LineBox[{{1.0954821374953965`, 0.3900000000000002}, {1.0959320802500556`,
       0.3900000000000002}, {1.0968453406598173`, 0.3900000000000002}, {
      1.0986718614793407`, 0.3900000000000002}, {1.100498382298864, 
      0.3900000000000002}, {1.1041514239379109`, 0.3900000000000002}, {
      1.1078044655769577`, 0.3900000000000002}, {1.1097857976305274`, 
      0.3900000000000002}, {1.1117671296840972`, 0.3900000000000002}, {
      1.1121567230556966`, 0.3900000000000002}}], 
     LineBox[{{1.1692905834345169`, 0.46000000000000024`}, {
      1.1702164252644074`, 0.46000000000000024`}, {1.1712070912911923`, 
      0.46000000000000024`}, {1.1749053062395387`, 0.46000000000000024`}, {
      1.1786035211878851`, 0.46000000000000024`}, {1.1804526286620582`, 
      0.46000000000000024`}, {1.1823017361362316`, 0.46000000000000024`}, {
      1.1832262898733181`, 0.46000000000000024`}, {1.184150843610405, 
      0.46000000000000024`}, {1.184333053651225, 0.46000000000000024`}}], 
     LineBox[{{1.2815778623141492`, 0.5300000000000002}, {1.282480416878447, 
      0.5300000000000002}, {1.2844843355866666`, 0.5300000000000002}, {
      1.2864882542948863`, 0.5300000000000002}, {1.2904960917113257`, 
      0.5300000000000002}, {1.2945039291277651`, 0.5300000000000002}, {
      1.2954876154944173`, 0.5300000000000002}, {1.29603064995983, 
      0.5300000000000002}}], 
     LineBox[{{1.4161845975185348`, 0.6700000000000004}, {1.4181745569064885`,
       0.6700000000000004}, {1.4198369502568986`, 0.6700000000000004}}], 
     LineBox[{{1.4645188606368318`, 0.7000000000000004}, {1.4719034603812444`,
       0.7000000000000004}, {1.4798632979330602`, 0.7000000000000004}, {
      1.4835787675501746`, 0.7000000000000004}, {1.4872942371672893`, 
      0.7000000000000004}, {1.488223104571568, 0.7000000000000004}, {
      1.4891519719758466`, 0.7000000000000004}, {1.4894167114767236`, 
      0.7000000000000004}}], 
     LineBox[{{1.539310811806894, 0.7500000000000004}, {1.5411320006405358`, 
      0.7500000000000004}, {1.542357352160141, 0.7500000000000004}}], 
     LineBox[{{1.5780859588377265`, 0.8000000000000005}, {1.5784663717301912`,
       0.8000000000000005}, {1.579376966147012, 0.8000000000000005}, {
      1.5811981549806537`, 0.8000000000000005}, {1.5830193438142954`, 
      0.8000000000000005}, {1.5903040991488622`, 0.8000000000000005}, {
      1.5975888544834291`, 0.8000000000000005}, {1.5995648545511174`, 
      0.8000000000000005}, {1.6015408546188055`, 0.8000000000000005}, {
      1.601615554037717, 0.8000000000000005}}], 
     LineBox[{{1.6540466932694664`, 0.8200000000000005}, {1.6548928564463856`,
       0.8200000000000005}, {1.6558808564802296`, 0.8200000000000005}, {
      1.656868856514074, 0.8200000000000005}, {1.6588448565817622`, 
      0.8200000000000005}, {1.6608208566494502`, 0.8200000000000005}, {
      1.6755710605557828`, 0.8200000000000005}, {1.6903212644621153`, 
      0.8200000000000005}, {1.6976963664152815`, 0.8200000000000005}, {
      1.7047294863966838`, 0.8200000000000005}}], 
     LineBox[{{1.706643058486304, 0.8300000000000005}, {1.7069152438567392`, 
      0.8300000000000005}, {1.707837131600885, 0.8300000000000005}, {
      1.7087590193450308`, 0.8300000000000005}, {1.7106027948333224`, 
      0.8300000000000005}, {1.7124465703216138`, 0.8300000000000005}, {
      1.716134121298197, 0.8300000000000005}, {1.7198216722747801`, 
      0.8300000000000005}, {1.7358103660534843`, 0.8300000000000005}, {
      1.7517990598321882`, 0.8300000000000005}, {1.7537976465545262`, 
      0.8300000000000005}, {1.7557962332768642`, 0.8300000000000005}, {
      1.756795526638033, 0.8300000000000005}, {1.7577948199992022`, 
      0.8300000000000005}, {1.7587477061096264`, 0.8300000000000005}}], 
     LineBox[{{1.7742220368250616`, 0.8500000000000005}, {1.7747828071390752`,
       0.8500000000000005}, {1.775782100500244, 0.8500000000000005}, {
      1.77977927394492, 0.8500000000000005}, {1.783776447389596, 
      0.8500000000000005}, {1.7994727733689753`, 0.8500000000000005}, {
      1.8151690993483545`, 0.8500000000000005}, {1.8160612893983634`, 
      0.8500000000000005}}], 
     LineBox[{{1.8179748614879836`, 0.8600000000000005}, {1.818112160469488, 
      0.8600000000000005}, {1.8190931808431992`, 0.8600000000000005}, {
      1.8210552215906217`, 0.8600000000000005}, {1.823017262338044, 
      0.8600000000000005}, {1.826941343832889, 0.8600000000000005}, {
      1.8308654253277337`, 0.8600000000000005}, {1.8387135883174235`, 
      0.8600000000000005}, {1.846561751307113, 0.8600000000000005}, {
      1.8612002806513195`, 0.8600000000000005}, {1.8749237196834119`, 
      0.8600000000000005}}], 
     LineBox[{{1.8923376867031505`, 0.8800000000000006}, {1.893222063591771, 
      0.8800000000000006}, {1.8941369716757839`, 0.8800000000000006}, {
      1.8959667878438098`, 0.8800000000000006}, {1.8977966040118355`, 
      0.8800000000000006}, {1.901456236347887, 0.8800000000000006}, {
      1.9051158686839387`, 0.8800000000000006}, {1.9368699071170945`, 
      0.8800000000000006}, {1.9686239455502506`, 0.8800000000000006}, {
      1.976033556840953, 0.8800000000000006}, {1.9834431681316556`, 
      0.8800000000000006}, {1.9852955709543312`, 0.8800000000000006}, {
      1.9871479737770068`, 0.8800000000000006}, {1.9871684176204554`, 
      0.8800000000000006}}], 
     LineBox[{{1.9937630758024185`, 0.9000000000000006}, {1.9945575850677093`,
       0.9000000000000006}, {1.996409987890385, 0.9000000000000006}, {
      1.9982623907130608`, 0.9000000000000006}, {2.013081613294466, 
      0.9000000000000006}, {2.027900835875871, 0.9000000000000006}, {
      2.029908049932593, 0.9000000000000006}, {2.0319152639893154`, 
      0.9000000000000006}, {2.032918871017676, 0.9000000000000006}, {
      2.0338931222631147`, 0.9000000000000006}}], 
     LineBox[{{2.035806694352735, 0.9100000000000006}, {2.0359296921027594`, 
      0.9100000000000006}, {2.0399441202162034`, 0.9100000000000006}, {
      2.0439585483296474`, 0.9100000000000006}, {2.051987404556536, 
      0.9100000000000006}, {2.0600162607834243`, 0.9100000000000006}, {
      2.076073973237201, 0.9100000000000006}, {2.0921316856909775`, 
      0.9100000000000006}, {2.1078970303454296`, 0.9100000000000006}, {
      2.1236623749998813`, 0.9100000000000006}, {2.1246477090407847`, 
      0.9100000000000006}, {2.125539122220396, 0.9100000000000006}}], 
     LineBox[{{2.128794148662192, 0.9300000000000006}, {2.129574379245301, 
      0.9300000000000006}, {2.130559713286204, 0.9300000000000006}, {
      2.131545047327107, 0.9300000000000006}, {2.1354863834907203`, 
      0.9300000000000006}, {2.139427719654333, 0.9300000000000006}, {
      2.1473103919815593`, 0.9300000000000006}, {2.155193064308785, 
      0.9300000000000006}, {2.1846081603473433`, 0.9300000000000006}, {
      2.2140232563859015`, 0.9300000000000006}, {2.277807407952504, 
      0.9300000000000006}, {2.3373603729784147`, 0.9300000000000006}, {
      2.395743866807027, 0.9300000000000006}, {2.399702457639408, 
      0.9300000000000006}, {2.4036610484717893`, 0.9300000000000006}, {
      2.404201272927539, 0.9300000000000006}}], 
     LineBox[{{2.406114845017159, 0.9400000000000006}, {2.406629991596075, 
      0.9400000000000006}, {2.4076196393041704`, 0.9400000000000006}, {
      2.409598934720361, 0.9400000000000006}, {2.4115782301365516`, 
      0.9400000000000006}, {2.419495411801314, 0.9400000000000006}, {
      2.427412593466076, 0.9400000000000006}, {2.4432469567956008`, 
      0.9400000000000006}, {2.4590813201251254`, 0.9400000000000006}, {
      2.4886344535138285`, 0.9400000000000006}, {2.518187586902532, 
      0.9400000000000006}, {2.566979435174245, 0.9400000000000006}}], 
     LineBox[{{2.582247813169425, 0.9500000000000006}, {2.5901091575531243`, 
      0.9500000000000006}, {2.5979705019368233`, 0.9500000000000006}, {
      2.598953169984786, 0.9500000000000006}, {2.5999358380327484`, 
      0.9500000000000006}, {2.600452025939793, 0.9500000000000006}}], 
     LineBox[{{2.6023655980294134`, 0.9600000000000006}, {2.6038665102245977`,
       0.9600000000000006}, {2.6058318463205223`, 0.9600000000000006}, {
      2.609762518512372, 0.9600000000000006}, {2.613693190704222, 
      0.9600000000000006}, {2.6294158794716207`, 0.9600000000000006}, {
      2.645138568239019, 0.9600000000000006}, {2.6744683525034705`, 
      0.9600000000000006}, {2.703798136767922, 0.9600000000000006}, {
      2.719701518772519, 0.9600000000000006}, {2.7356049007771164`, 
      0.9600000000000006}, {2.7435565917794147`, 0.9600000000000006}, {
      2.7515082827817134`, 0.9600000000000006}, {2.7554841282828626`, 
      0.9600000000000006}, {2.759459973784012, 0.9600000000000006}, {
      2.7604539351592994`, 0.9600000000000006}, {2.761274383231656, 
      0.9600000000000006}}], 
     LineBox[{{2.763187955321276, 0.9700000000000006}, {2.7634358192851614`, 
      0.9700000000000006}, {2.765423742035736, 0.9700000000000006}, {
      2.7674116647863105`, 0.9700000000000006}, {2.797102835525159, 
      0.9700000000000006}, {2.826794006264008, 0.9700000000000006}, {
      2.8850068765444066`, 0.9700000000000006}, {2.9007985839868775`, 
      0.9700000000000006}, {2.916590291429349, 0.9700000000000006}, {
      2.9185642548596578`, 0.9700000000000006}, {2.919605796835308, 
      0.9700000000000006}}], 
     LineBox[{{2.9215252000051217`, 0.9800000000000006}, {2.922512181720276, 
      0.9800000000000006}, {2.92349916343543, 0.9800000000000006}, {
      2.924486145150585, 0.9800000000000006}, {2.9284340720112025`, 
      0.9800000000000006}, {2.9323819988718203`, 0.9800000000000006}, {
      2.9402778525930557`, 0.9800000000000006}, {2.948173706314291, 
      0.9800000000000006}, {2.977641527928888, 0.9800000000000006}, {
      3.0071093495434846`, 0.9800000000000006}, {3.0111024497134022`, 
      0.9800000000000006}, {3.01509554988332, 0.9800000000000006}, {
      3.0170920999682784`, 0.9800000000000006}, {3.019088650053237, 
      0.9800000000000006}, {3.0200869250957165`, 0.9800000000000006}, {
      3.021085200138196, 0.9800000000000006}, {3.021652067395799, 
      0.9800000000000006}}], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQPdFwup6zAYfDFveHVSLr3ttn/dzTu8AewZ9hkj7/
tz+C/2nV7kMbCxB8X0WBZ+kTEfwnp2b+qzuH4FeXKItP4+aE8/Myi1TimxF8
tYCPdb6sXHD+wg2GtRPrEPxHTItO/GLkhvOff/P98K8JwV+fsnt3xG8E3+ZI
xJXrtTxwfu/c7RPWfEfwF0kEacrk88L5Na0y/Bs/IPhSOStmzM7kQ7jvTsV9
ibUIvqGPp9q0Dwg+AA31mm0=
      "]], 
     LineBox[{{0.8902030947807115, 0.03}, {0.8909192153114291, 0.03}, {
      0.8918394553813237, 0.03}, {0.8927596954512182, 0.03}, {
      0.8946001755910074, 0.03}, {0.8964406557307966, 0.03}, {
      0.9001216160103749, 0.03}, {0.9038025762899531, 0.03}, {
      0.9047228163598476, 0.03}, {0.9056430564297422, 0.03}, {
      0.9058759761948877, 0.03}}], 
     LineBox[{{0.9522799983381763, 0.16}, {0.9528247715142033, 0.16}, {
      0.9538224172011212, 0.16}, {0.9558177085749567, 0.16}, {
      0.9578129999487923, 0.16}, {0.9618035826964635, 0.16}, {
      0.9657941654441347, 0.16}, {0.9667918111310525, 0.16}, {
      0.9677894568179702, 0.16}, {0.9678949248137049, 0.16}}], 
     LineBox[{{1.0195467306411854`, 0.2700000000000001}, {1.0214097974356244`,
       0.2700000000000001}, {1.0229402073863707`, 0.2700000000000001}}], 
     LineBox[{{1.138148882204111, 0.4200000000000002}, {1.13851511240729, 
      0.4200000000000002}, {1.139505778434075, 0.4200000000000002}, {
      1.141487110487645, 0.4200000000000002}, {1.1434684425412147`, 
      0.4200000000000002}, {1.1444591085679996`, 0.4200000000000002}, {
      1.1445230867292464`, 0.4200000000000002}}], 
     LineBox[{{1.1862466257408453`, 0.47000000000000025`}, {
      1.1933963809812709`, 0.47000000000000025`}, {1.200792810877964, 
      0.47000000000000025`}, {1.21558567067135, 0.47000000000000025`}, {
      1.2302322959142173`, 0.47000000000000025`}}], 
     LineBox[{{1.2624706482637447`, 0.5100000000000002}, {1.2664490672126898`,
       0.5100000000000002}, {1.2696096990318706`, 0.5100000000000002}}], 
     LineBox[{{1.3201998676687314`, 0.5700000000000003}, {1.3210634610273702`,
       0.5700000000000003}, {1.3220471473940223`, 0.5700000000000003}, {
      1.3240145201273263`, 0.5700000000000003}, {1.3259818928606304`, 
      0.5700000000000003}, {1.3299166383272385`, 0.5700000000000003}, {
      1.3338513837938466`, 0.5700000000000003}, {1.3348350701604987`, 
      0.5700000000000003}, {1.3350295584190213`, 0.5700000000000003}}], 
     LineBox[{{1.3696264566798266`, 0.6500000000000004}, {1.370305893670848, 
      0.6500000000000004}, {1.371223467747802, 0.6500000000000004}, {
      1.3721410418247555`, 0.6500000000000004}, {1.3794816344403853`, 
      0.6500000000000004}, {1.3868222270560153`, 0.6500000000000004}, {
      1.3941628196716451`, 0.6500000000000004}, {1.4006993753046424`, 
      0.6500000000000004}}], 
     LineBox[{{1.4351522886368635`, 0.6900000000000004}, {1.436084191398074, 
      0.6900000000000004}, {1.438074150786028, 0.6900000000000004}, {
      1.4400641101739817`, 0.6900000000000004}, {1.4440440289498895`, 
      0.6900000000000004}, {1.4480239477257975`, 0.6900000000000004}, {
      1.4520038665017054`, 0.6900000000000004}, {1.4559837852776132`, 
      0.6900000000000004}, {1.457973744665567, 0.6900000000000004}, {
      1.459963704053521, 0.6900000000000004}, {1.460958683747498, 
      0.6900000000000004}, {1.461953663441475, 0.6900000000000004}, {
      1.4626052885472116`, 0.6900000000000004}}], 
     LineBox[{{1.4913302835663438`, 0.7100000000000004}, {1.4928674415929613`,
       0.7100000000000004}, {1.4947251764015186`, 0.7100000000000004}, {
      1.502156115635748, 0.7100000000000004}, {1.5095870548699772`, 
      0.7100000000000004}, {1.513302524487092, 0.7100000000000004}, {
      1.5161438804556036`, 0.7100000000000004}}], 
     LineBox[{{1.5684498331451615`, 0.7800000000000005}, {1.5702710219788032`,
       0.7800000000000005}, {1.5720922108124449`, 0.7800000000000005}, {
      1.5724947728212257`, 0.7800000000000005}}], 
     LineBox[{{1.6035291261273372`, 0.8100000000000005}, {1.6045048547203375`,
       0.8100000000000005}, {1.6054928547541816`, 0.8100000000000005}, {
      1.609444854889558, 0.8100000000000005}, {1.6133968550249342`, 
      0.8100000000000005}, {1.621300855295687, 0.8100000000000005}, {
      1.6292048555664396`, 0.8100000000000005}, {1.6371088558371922`, 
      0.8100000000000005}, {1.645012856107945, 0.8100000000000005}, {
      1.6489648562433212`, 0.8100000000000005}, {1.6521331211798462`, 
      0.8100000000000005}}], 
     LineBox[{{0.8819428350371955, 0.02}, {0.8853977748920617, 0.02}, {
      0.8882895226910911, 0.02}}], 
     LineBox[{{0.938971923454041, 0.11999999999999998`}, {0.9398553775842721, 
      0.11999999999999998`}, {0.9408530232711898, 0.11999999999999998`}, {
      0.9418506689581077, 0.11999999999999998`}, {0.942015693119549, 
      0.11999999999999998`}}], 
     LineBox[{{1.0026089038783577`, 0.23000000000000007`}, {
      1.0027791294912345`, 0.23000000000000007`}, {1.003710662888454, 
      0.23000000000000007`}, {1.0046421962856735`, 0.23000000000000007`}, {
      1.0065052630801126`, 0.23000000000000007`}, {1.0083683298745516`, 
      0.23000000000000007`}, {1.0092998632717711`, 0.23000000000000007`}, {
      1.009713106610726, 0.23000000000000007`}}], 
     LineBox[{{1.0618972113194074`, 0.34000000000000014`}, {
      1.0621414450888729`, 0.34000000000000014`}, {1.0630547054986346`, 
      0.34000000000000014`}, {1.0639679659083963`, 0.34000000000000014`}, {
      1.067621007547443, 0.34000000000000014`}, {1.0712740491864898`, 
      0.34000000000000014`}, {1.0721873095962515`, 0.34000000000000014`}, {
      1.0731005700060132`, 0.34000000000000014`}, {1.0731084092319703`, 
      0.34000000000000014`}}], 
     LineBox[{{1.1140702951453167`, 0.4000000000000002}, {1.114739127764452, 
      0.4000000000000002}, {1.115729793791237, 0.4000000000000002}, {
      1.1196924578983767`, 0.4000000000000002}, {1.1236551220055162`, 
      0.4000000000000002}, {1.127617786112656, 0.4000000000000002}, {
      1.1315804502197957`, 0.4000000000000002}, {1.1335617822733655`, 
      0.4000000000000002}, {1.1355431143269352`, 0.4000000000000002}, {
      1.1362353101144909`, 0.4000000000000002}}], 
     LineBox[{{1.2384301946997998`, 0.49000000000000027`}, {
      1.2424020427140539`, 0.49000000000000027`}, {1.246409880130493, 
      0.49000000000000027`}, {1.2504177175469322`, 0.49000000000000027`}, {
      1.2544255549633716`, 0.49000000000000027`}, {1.2554275143174816`, 
      0.49000000000000027`}, {1.2564294736715913`, 0.49000000000000027`}, {
      1.256522152566122, 0.49000000000000027`}}], 
     LineBox[{{1.4217505223465188`, 0.6800000000000004}, {1.4221544756823965`,
       0.6800000000000004}, {1.4231494553763735`, 0.6800000000000004}, {
      1.4241444350703505`, 0.6800000000000004}, {1.4281243538462582`, 
      0.6800000000000004}, {1.432104272622166, 0.6800000000000004}, {
      1.433099252316143, 0.6800000000000004}, {1.4332387165472433`, 
      0.6800000000000004}}], 
     LineBox[{{1.5442709242497612`, 0.7600000000000005}, {1.5447743783078192`,
       0.7600000000000005}, {1.54568497272464, 0.7600000000000005}, {
      1.5465955671414608`, 0.7600000000000005}, {1.5502379448087442`, 
      0.7600000000000005}, {1.5538803224760278`, 0.7600000000000005}, {
      1.5557015113096697`, 0.7600000000000005}, {1.5575227001433114`, 
      0.7600000000000005}, {1.5584332945601322`, 0.7600000000000005}, {
      1.5584684507044844`, 0.7600000000000005}}], 
     LineBox[{{0.9116801580831304, 0.05}, {0.914845457128688, 0.05}, {
      0.9185264174082663, 0.05}, {0.9194466574781609, 0.05}, {
      0.9203668975480555, 0.05}, {0.9206826052084786, 0.05}}], 
     LineBox[{{0.9746349066306889, 0.19000000000000003`}, {0.9757706223133126,
       0.19000000000000003`}, {0.9777659136871482, 0.19000000000000003`}, {
      0.978763559374066, 0.19000000000000003`}, {0.9797612050609837, 
      0.19000000000000003`}, {0.9800706344901935, 0.19000000000000003`}}], 
     LineBox[{{1.0328917503529627`, 0.3000000000000001}, {1.0335197315994777`,
       0.3000000000000001}, {1.0344512649966973`, 0.3000000000000001}, {
      1.035119631924561, 0.3000000000000001}}], 
     LineBox[{{1.0881726898297903`, 0.38000000000000017`}, {1.088625996971962,
       0.38000000000000017`}, {1.0895392573817237`, 0.38000000000000017`}, {
      1.0913657782012471`, 0.38000000000000017`}, {1.0931922990207705`, 
      0.38000000000000017`}, {1.0935685654057763`, 0.38000000000000017`}}], 
     LineBox[{{1.1553564348626337`, 0.4400000000000002}, {1.1563471008894186`,
       0.4400000000000002}, {1.1573094135369684`, 0.4400000000000002}}], 
     LineBox[{{1.2715232711214908`, 0.5200000000000002}, {1.272460823337349, 
      0.5200000000000002}, {1.2734627826914586`, 0.5200000000000002}, {
      1.2744647420455686`, 0.5200000000000002}, {1.276468660753788, 
      0.5200000000000002}, {1.2784725794620078`, 0.5200000000000002}, {
      1.2794745388161175`, 0.5200000000000002}, {1.279664290224529, 
      0.5200000000000002}}], 
     LineBox[{{1.7606612781992466`, 0.8400000000000005}, {1.7637905801662161`,
       0.8400000000000005}, {1.7677877536108921`, 0.8400000000000005}, {
      1.7697863403332301`, 0.8400000000000005}, {1.7717849270555681`, 
      0.8400000000000005}, {1.7723084647354415`, 0.8400000000000005}}], 
     LineBox[{{0.9341563372885058, 0.10999999999999999`}, {0.9358647948366009,
       0.10999999999999999`}, {0.9370583513644206, 0.10999999999999999`}}], 
     LineBox[{{1.0507291977296995`, 0.3200000000000001}, {1.0511823201717325`,
       0.3200000000000001}, {1.0520955805814942`, 0.3200000000000001}, {
      1.053008840991256, 0.3200000000000001}, {1.0548353618107793`, 
      0.3200000000000001}, {1.0566618826303027`, 0.3200000000000001}, {
      1.058488403449826, 0.3200000000000001}, {1.0599836392297872`, 
      0.3200000000000001}}], 
     LineBox[{{1.2979442220494501`, 0.5400000000000003}, {1.2984386745943732`,
       0.5400000000000003}, {1.3004060473276773`, 0.5400000000000003}, {
      1.3023734200609813`, 0.5400000000000003}, {1.309084264411907, 
      0.5400000000000003}}], 
     LineBox[{{1.3652447843890356`, 0.6400000000000003}, {1.366635597363033, 
      0.6400000000000003}, {1.3677128845902065`, 0.6400000000000003}}], 
     LineBox[{{1.0262995865575446`, 0.2900000000000001}, {1.0269989978189413`,
       0.2900000000000001}, {1.0288620646133801`, 0.2900000000000001}, {
      1.0307251314078192`, 0.2900000000000001}, {1.0309781782633425`, 
      0.2900000000000001}}], 
     LineBox[{{1.086501322414061, 0.37000000000000016`}, {1.086501322414061, 
      0.37000000000000016`}}], 
     LineBox[{{1.1464404406215694`, 0.4300000000000002}, {1.1474311066483542`,
       0.4300000000000002}, {1.149367632084728, 0.4300000000000002}}], 
     LineBox[{{1.574408344910846, 0.7900000000000005}, {1.5748239940629074`, 
      0.7900000000000005}, {1.5757345884797285`, 0.7900000000000005}, {
      1.5761723867481063`, 0.7900000000000005}}], 
     LineBox[{{1.876837291773032, 0.8700000000000006}, {1.8776686261635516`, 
      0.8700000000000006}, {1.8785835342475645`, 0.8700000000000006}, {
      1.8794984423315775`, 0.8700000000000006}, {1.8813282584996034`, 
      0.8700000000000006}, {1.883158074667629, 0.8700000000000006}, {
      1.8868177070036807`, 0.8700000000000006}, {1.8904241146135303`, 
      0.8700000000000006}}], 
     LineBox[{{0.9500892266379543, 0.15}, {0.9503664262485559, 0.15}}], 
     LineBox[{{1.0116266787003463`, 0.25000000000000006`}, {
      1.0120944634634295`, 0.25000000000000006`}, {1.0120944634634295`, 
      0.25000000000000006`}}], 
     LineBox[{{1.3112265973608497`, 0.5600000000000003}, {1.3122102837275018`,
       0.5600000000000003}, {1.313193970094154, 0.5600000000000003}, {
      1.314177656460806, 0.5600000000000003}, {1.3161450291941101`, 
      0.5600000000000003}, {1.3181124019274142`, 0.5600000000000003}, {
      1.3182862955791113`, 0.5600000000000003}}], 
     LineBox[{{1.5603820227941045`, 0.7700000000000005}, {1.5611650778105948`,
       0.7700000000000005}, {1.5625392430821925`, 0.7700000000000005}}], 
     LineBox[{{1.9890819897100755`, 0.8900000000000006}, {1.9899265780110202`,
       0.8900000000000006}, {1.990852779422358, 0.8900000000000006}, {
      1.9917789808336959`, 0.8900000000000006}, {1.9918495037127983`, 
      0.8900000000000006}}], 
     LineBox[{{0.9819842065798139, 0.20000000000000004`}, {0.9837517878086549,
       0.20000000000000004`}, {0.9849288229457138, 0.20000000000000004`}}], 
     LineBox[{{1.0370332040141812`, 0.3100000000000001}, {1.0372458651883558`,
       0.3100000000000001}, {1.0381773985855753`, 0.3100000000000001}, {
      1.0400404653800144`, 0.3100000000000001}, {1.0419035321744532`, 
      0.3100000000000001}, {1.045629665763331, 0.3100000000000001}, {
      1.0488156256400794`, 0.3100000000000001}}], 
     LineBox[{{1.1592229856265885`, 0.45000000000000023`}, {
      1.1593190989697733`, 0.45000000000000023`}, {1.161300431023343, 
      0.45000000000000023`}, {1.163281763076913, 0.45000000000000023`}, {
      1.165263095130483, 0.45000000000000023`}, {1.1672444271840527`, 
      0.45000000000000023`}, {1.1673770113448967`, 0.45000000000000023`}}], 
     LineBox[{{1.4026129473942626`, 0.6600000000000004}, {1.4033385604411825`,
       0.6600000000000004}, {1.4042561345181364`, 0.6600000000000004}, {
      1.40517370859509, 0.6600000000000004}, {1.4070088567489973`, 
      0.6600000000000004}, {1.408844004902905, 0.6600000000000004}, {
      1.4097901339282688`, 0.6600000000000004}}], 
     LineBox[{{1.5254764342030687`, 0.7400000000000004}, {1.5263066681469928`,
       0.7400000000000004}, {1.5272355355512715`, 0.7400000000000004}, {
      1.5281644029555501`, 0.7400000000000004}, {1.5300221377641074`, 
      0.7400000000000004}, {1.5318798725726648`, 0.7400000000000004}, {
      1.5338260522806306`, 0.7400000000000004}}], 
     LineBox[{{0.9293170736731894, 0.08}, {0.9298789207150941, 0.08}, {
      0.9303999830000912, 0.08}}], 
     LineBox[{{1.2321458680038375`, 0.48000000000000026`}, {
      1.2323824491729554`, 0.48000000000000026`}, {1.233384408527065, 
      0.48000000000000026`}, {1.234386367881175, 0.48000000000000026`}, {
      1.235388327235285, 0.48000000000000026`}, {1.2363902865893948`, 
      0.48000000000000026`}, {1.2365166226101796`, 0.48000000000000026`}}], 
     LineBox[{{1.359041682592278, 0.6300000000000003}, {1.3592950047474033`, 
      0.6300000000000003}, {1.360212578824357, 0.6300000000000003}, {
      1.3611301529013107`, 0.6300000000000003}, {1.3620477269782643`, 
      0.6300000000000003}, {1.362965301055218, 0.6300000000000003}, {
      1.3633312122994155`, 0.6300000000000003}}], 
     LineBox[{{1.0799333798109905`, 0.36000000000000015`}, {
      1.0804066532841068`, 0.36000000000000015`}, {1.0813199136938685`, 
      0.36000000000000015`}, {1.0822331741036302`, 0.36000000000000015`}, {
      1.0831464345133919`, 0.36000000000000015`}, {1.0840596949231536`, 
      0.36000000000000015`}, {1.0845877503244408`, 0.36000000000000015`}}], 
     LineBox[{{1.3435355775359175`, 0.6100000000000003}, {1.343688247460367, 
      0.6100000000000003}, {1.3446719338270192`, 0.6100000000000003}, {
      1.3456556201936714`, 0.6100000000000003}, {1.3476229929269754`, 
      0.6100000000000003}, {1.3494658695894668`, 0.6100000000000003}}], 
     LineBox[{{0.9077895482845081, 0.04}, {0.908403776639426, 0.04}, {
      0.9093240167093206, 0.04}, {0.90976658599351, 0.04}}], 
     LineBox[{{0.9698084969033253, 0.17}, {0.9698084969033253, 0.17}}], 
     LineBox[{{1.3369431305086414`, 0.5900000000000003}, {1.3377861292604547`,
       0.5900000000000003}, {1.3387698156271068`, 0.5900000000000003}, {
      1.3389645977759508`, 0.5900000000000003}}], 
     LineBox[{{1.5194610435161053`, 0.7300000000000004}, {1.5198045963170426`,
       0.7300000000000004}, {1.5207334637213212`, 0.7300000000000004}, {
      1.5225911985298786`, 0.7300000000000004}, {1.5235628621134485`, 
      0.7300000000000004}}], 
     LineBox[{{1.0750219813215904`, 0.35000000000000014`}, {1.07675361164506, 
      0.35000000000000014`}, {1.0780198077213703`, 0.35000000000000014`}}], 
     LineBox[{{1.2584357246557423`, 0.5000000000000002}, {1.259435351733921, 
      0.5000000000000002}, {1.2604373110880307`, 0.5000000000000002}, {
      1.2605570761741245`, 0.5000000000000002}}], 
     LineBox[{{0.922596177298099, 0.060000000000000005`}, {0.9232574765968958,
       0.060000000000000005`}}], 
     LineBox[{{1.351379441679087, 0.6200000000000003}, {1.3515577383935835`, 
      0.6200000000000003}, {1.3525414247602354`, 0.6200000000000003}, {
      1.3535251111268876`, 0.6200000000000003}, {1.3554924838601916`, 
      0.6200000000000003}, {1.3571281105026578`, 0.6200000000000003}}], 
     LineBox[{{0.9439292652091694, 0.12999999999999998`}, {0.944843606018861, 
      0.12999999999999998`}, {0.9457313795353461, 0.12999999999999998`}}], 
     LineBox[{{0.9323135550897116, 0.09}, {0.9323135550897116, 0.09}}], 
     LineBox[{{0.9476449516249665, 0.13999999999999999`}, {0.9478365430796144,
       0.13999999999999999`}, {0.9481756545483339, 0.13999999999999999`}}], 
     LineBox[{{0.97108885788303, 0.18000000000000002`}, {0.9717800395656414, 
      0.18000000000000002`}, {0.9727213345410685, 0.18000000000000002`}}], 
     LineBox[{{0.9868423950353342, 0.21000000000000005`}, {0.9877423705563261,
       0.21000000000000005`}, {0.9886543275286843, 0.21000000000000005`}}], 
     LineBox[{{1.5180574525452237`, 0.7200000000000004}, {1.5180574525452237`,
       0.7200000000000004}}], 
     LineBox[{{1.0248537794759909`, 0.2800000000000001}, {1.0248537794759909`,
       0.2800000000000001}}], 
     LineBox[{{2.127452694310016, 0.9200000000000006}, {2.127452694310016, 
      0.9200000000000006}}], 
     LineBox[{{1.340878169865571, 0.6000000000000003}, {1.3416220054462973`, 
      0.6000000000000003}}]}, {}}, {{}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{1., 0},
  ImageSize->{527.92578125, Automatic},
  Method->{},
  PlotRange->{{0.8669929122598634, 3.867473948784533}, {0., 
   0.9900000000000007}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.593862716943925*^9, 3.593862848839553*^9, {3.593869796442265*^9, 
   3.593869805112043*^9}, 3.593872957129775*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Default Parameters", "Subsection",
 CellChangeTimes->{{3.592183416123457*^9, 3.592183427849206*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "defaultUniverse", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Hobs", "\[Rule]", "2.*^-18"}], ",", 
     RowBox[{"\[CapitalOmega]m", "\[Rule]", "0.317"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"defaultUniverse", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Hobs", "]"}], ",", 
     RowBox[{"OptionValue", "[", "\[CapitalOmega]m", "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.592183431358851*^9, 3.592183460249783*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "defaultPopulation", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"density0", "\[Rule]", "0.655427*^-50"}], ",", 
     RowBox[{"index", "\[Rule]", "3"}], ",", 
     RowBox[{"zc", "\[Rule]", "3."}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"defaultPopulation", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"OptionValue", "[", "density0", "]"}], ",", 
     RowBox[{"OptionValue", "[", "index", "]"}], ",", 
     RowBox[{"OptionValue", "[", "zc", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.592196285224616*^9, 3.592196414912092*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "defaultBurst", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Gamma]", "\[Rule]", "100."}], ",", 
     RowBox[{"\[Eta]0", "\[Rule]", "1.*^45"}], ",", 
     RowBox[{"r0", "\[Rule]", "2.*^3"}], ",", 
     RowBox[{"n", "\[Rule]", "6"}], ",", 
     RowBox[{"\[Omega]0", "\[Rule]", "1."}], ",", 
     RowBox[{"\[Theta]0", "\[Rule]", "2.5*^-5"}], ",", 
     RowBox[{"k", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"defaultBurst", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"OptionValue", "[", "\[Gamma]", "]"}], ",", 
     RowBox[{"OptionValue", "[", "\[Eta]0", "]"}], ",", 
     RowBox[{"OptionValue", "[", "r0", "]"}], ",", 
     RowBox[{"OptionValue", "[", "n", "]"}], ",", 
     RowBox[{"OptionValue", "[", "\[Omega]0", "]"}], ",", 
     RowBox[{"OptionValue", "[", "\[Theta]0", "]"}], ",", 
     RowBox[{"OptionValue", "[", "k", "]"}], ",", 
     RowBox[{"OptionValue", "[", "\[Alpha]", "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.592183471082691*^9, 3.592183527567327*^9}, {
   3.592185444675672*^9, 3.592185456046914*^9}, 3.592185591584156*^9, {
   3.5921856928131227`*^9, 3.592185694458848*^9}, {3.592577850303637*^9, 
   3.592577874748348*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"defaultDetectorArea", "[", "]"}], ":=", "5.563*^-18"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.592183544436002*^9, 3.592183552917884*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "defaultObserver", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"detectorArea", "\[Rule]", 
      RowBox[{"defaultDetectorArea", "[", "]"}]}], ",", 
     RowBox[{"z", "\[Rule]", "1."}], ",", 
     RowBox[{"\[Chi]", "\[Rule]", "0."}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"defaultObserver", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"OptionValue", "[", "detectorArea", "]"}], ",", 
     RowBox[{"OptionValue", "[", "z", "]"}], ",", 
     RowBox[{"OptionValue", "[", "\[Chi]", "]"}]}], "}"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.5921835325126457`*^9, 3.592183542805168*^9}, {
  3.5921836390243387`*^9, 3.592183678941724*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Local",
WindowSize->{1221, 756},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 184, 2, 92, "Title"],
Cell[CellGroupData[{
Cell[631, 21, 92, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[748, 26, 98, 1, 44, "Subsection"],
Cell[849, 29, 208, 5, 28, "Input"],
Cell[1060, 36, 217, 6, 28, "Input"],
Cell[1280, 44, 305, 8, 28, "Input"],
Cell[1588, 54, 221, 6, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1846, 65, 98, 1, 44, "Subsection"],
Cell[1947, 68, 317, 9, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2301, 82, 101, 1, 44, "Subsection"],
Cell[2405, 85, 254, 6, 28, "Input"],
Cell[2662, 93, 1763, 46, 70, "Input"],
Cell[4428, 141, 1078, 19, 32, "Input"],
Cell[5509, 162, 498, 14, 54, "Input"],
Cell[6010, 178, 933, 29, 63, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6980, 212, 101, 1, 44, "Subsection"],
Cell[7084, 215, 2121, 55, 148, "Input"],
Cell[9208, 272, 2247, 61, 215, "Input"],
Cell[11458, 335, 7239, 150, 374, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18734, 490, 96, 1, 44, "Subsection"],
Cell[18833, 493, 3260, 75, 194, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22130, 573, 105, 1, 44, "Subsection"],
Cell[22238, 576, 1253, 32, 180, "Input"],
Cell[23494, 610, 4599, 108, 347, "Input"],
Cell[28096, 720, 15783, 333, 814, "Input"],
Cell[43882, 1055, 2922, 66, 148, "Input"],
Cell[46807, 1123, 267, 7, 28, "Input"],
Cell[47077, 1132, 368, 9, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47482, 1146, 102, 1, 44, "Subsection"],
Cell[47587, 1149, 1205, 39, 60, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48829, 1193, 100, 1, 44, "Subsection"],
Cell[48932, 1196, 2585, 62, 165, "Input"],
Cell[51520, 1260, 2979, 70, 265, "Input"],
Cell[54502, 1332, 989, 20, 46, "Input"],
Cell[55494, 1354, 1086, 24, 46, "Input"],
Cell[56583, 1380, 1377, 36, 97, "Input"],
Cell[57963, 1418, 462, 13, 41, "Input"],
Cell[58428, 1433, 18197, 369, 1185, "Input"],
Cell[CellGroupData[{
Cell[76650, 1806, 1526, 26, 28, "Input"],
Cell[78179, 1834, 629, 12, 24, "Message"],
Cell[78811, 1848, 631, 12, 24, "Message"],
Cell[79445, 1862, 629, 12, 24, "Message"],
Cell[80077, 1876, 586, 12, 24, "Message"],
Cell[80666, 1890, 216, 3, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80919, 1898, 417, 11, 28, "Input"],
Cell[81339, 1911, 29251, 440, 350, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110639, 2357, 106, 1, 44, "Subsection"],
Cell[110748, 2360, 630, 18, 46, "Input"],
Cell[111381, 2380, 712, 18, 46, "Input"],
Cell[112096, 2400, 1444, 34, 63, "Input"],
Cell[113543, 2436, 188, 5, 28, "Input"],
Cell[113734, 2443, 807, 22, 46, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

